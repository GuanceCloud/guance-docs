<!-- 不要在 dataflux-doc 仓库直接修改本文件，该文件由 Dataway 项目自动导出 -->
# 更新历史 {#changelog}

## 1.8.0(2025/02/19) {#cl-1.8.0}

### 新增功能 {#cl-1.8.0-new}

- Dataway 开启 Sinker 模式下，支持同时处理客户端（如 Datakit/Function）发送过来的数据上报请求（#50）

---

## 1.7.0(2024/12/18) {#cl-1.7.0}

### 新增功能 {#cl-1.7.0-new}

- 新增 AWS Firehose 接入入口（#47）
- 支持通过 `X-Token` 传递 token（#43）

### 功能优化 {#cl-1.7.0-opt}

- 调整内部回收的默认参数，优化内存使用（#49）
- 优化 Kubernetes 部署中的默认 yaml，调整其 cache 磁盘挂载配置（#48）
- 调整并增加部份内部指标，更新 Dataway 默认视图

---

## 1.6.2(2024/12/03) {#cl-1.6.2}

### 功能优化 {#cl-1.6.2-opt}

- 增加 HTTP 层面的连接配置入口（#46）

---

## 1.6.1(2024/11/19) {#cl-1.6.1}

### 功能优化 {#cl-1.6.1-opt}

- 增加选项以禁用 404 页面（#44）

---

## 1.6.0(2024/09/19) {#cl-1.6.0}

### 功能优化 {#cl-1.6.0-opt}

- 优化磁盘缓存相关的[环境变量配置](dataway.md#env-diskcache)
- 增加更多自身指标暴露，同时优化了一些 HTTP 转发层面内存的使用（#39）
- Dataway 支持[配置自身 SNI](dataway.md#env-apis)（#42）
- 新增对时接口，便于 Datakit 获取较为准确的 Unix 时间戳（#40）
- Sinker：
    - 过滤条件支持 [`nil` 判断](../datakit/datakit-filter.md#nil)，即判定某个具体的字段是否存在（#41）
    - 增加[默认规则设置](dataway-sink.md#default-rule)，即不符合已有分流规则的请求，都会引流到该默认规则对应的工作空间（#30）

---

## 1.5.0(2024/07/05) {#cl-1.5.0}

### 功能优化 {#cl-1.5.0-opt}

- 优化安装脚本（#33）

### 兼容调整 {#cl-1.5.0-brk}

- 新版本移除了主机安装模式下直接支持 Sinker 配置的功能。该功能后续会通过新的方式予以支持。

---

## 1.4.1(2024/06/19) {#cl-1.4.1}

- 修复 Kubernetes 安装模式下 `DW_ENABLE_TLS` 缺失问题
- 更换构建镜像地址

---

## 1.4.0(2024/05/15) {#cl-1.4.0}

- 新增 Datakit 计量接口（#29）
- 修复 cache 可能丢失数据的问题（#31）
- 支持在 Dataway 端直接配置 HTTP TLS 证书（#32）
- 增加更多指标暴露

---

## 1.3.9(2024/03/28) {#cl-1.3.9}

- Sink 丢弃请求时，增加返回 HTTP `406 Not Acceptable` 错误，便于排查问题（#82）

---

## 1.3.8(2024/01/24) {#cl-1.3.8}

- 新增更多指标暴露
- 大幅度提升 Sinker 规则匹配性能（#26）
---

## 1.3.7(2023/12/14) {#cl-1.3.7}

- 新增更多指标暴露
- 优化磁盘缓存清理策略，采集尽快消费原则：
    - 避免存储超限导致数据主动丢弃
    - 同时尽早将缓存的数据发送上去
- 增加超大请求丢弃相关的可观测性（[指标/日志](dataway.md#too-large-request-body)）
- 调整 [Dataway 自身 POD yaml](https://static.<<< custom_key.brand_main_domain >>>/dataway/dataway.yaml)，完善其指标和日志采集
---

## 1.3.6(2023/10/24) {#cl-1.3.6}

- 新增 Dataway `sink` [管理命令](./dataway-sink.md#dw-sink-command)

---

## 1.3.5(2023/09/13) {#cl-1.3.5}

- Kubernetes 下支持通过[环境变量](dataway.md#img-envs)注入来安装 Dataway
- 新发布了 [dataway.yaml](https://static.<<< custom_key.brand_main_domain >>>/dataway/dataway.yaml){:target="_blank"}

---

## 1.3.4(2023/09/01) {#cl-1.3.4}

- 升级 Golang 到 1.9
- 修复 inner token 无数据问题
- 默认配置中调整如下配置：
    - 默认 API 限流增加到 100K
    - 默认最大 Body 增加到 64MB
    - 新增 HTTP 超时设置（Dataway 到中心），默认 30s
    - 新增配置以忽略 TLS 509 报错

## 1.3.3(2023/09/01) {#cl-1.3.3}

- 修复镜像打包 `curl` 问题

---

## 1.3.2(2023/08/30) {#cl-1.3.2}

- 镜像中增加 `curl` 命令，便于查看自身指标

---

## 1.3.1(2023/08/28) {#cl-1.3.1}

- 增加 URL 的 Sinker 功能

---

## 1.3.0(2023/08/24) {#cl-1.3.0}

- 重构整个 Dataway 实现，增加 Sinker 功能

---

## 1.2.12(2023/08/28) {#cl-1.2.12}

- 重构 CI 发布流程，实现 install 脚本双发布

---

## 1.2.8(2022/09/18) {#cl-1.2.8}

- /v1/wirte 接口更新：
    - 移除冗余的 /v1/write/xxx API，增加 /v1/write/:category 接口
    - 写入数据不再进行行协议解码，但仍然进行 Body 读取，用于签名

- 磁盘缓存：
    - 当缓存清理过程中发送中心失败，增加消费暂停策略，直到当前缓存的请求发送成功才清理下一个缓存
    - 更新 pbcache proto 文件
