# 外部事件检测

外部事件检测用于接收第三方系统产生的异常记录并产生相关事件，通过检测规则中标准的 Webhook 地址在观测云生成相应的监控器事件数据和相应的告警策略及可视化仪表板。

## 应用场景

将第三方系统产生的异常事件或记录通过指定 URL 地址，以 POST 请求方式发送到 HTTP 服务器后生成观测云的事件数据。

## 新建

点击**监控器 > 新建监控器 > 外部事件检测**，进入规则的配置页面。

![](../img/third-party.png)

### 步骤一：默认配置

1）**监控器名称**：支持自定义名称

2）**Webhook 地址**：默认进入创建页面时生成 Webhook 地址，支持自定义追加参数标记地址用途。

外部事件数据由第三方系统主动向观测云中心上报，并提供必要的事件数据。只有检测并匹配到对应字段才能生成事件产生异常记录后进行告警。

必需字段可参见下图示例：必须包含 `event` 下的五大字段才能与观测云侧匹配成功；`extra_data` 则为自定义添加的字段：

```
{
    "event": {
        "status": "warning",
        "title": "外部事件监控器测试1",
        "message": "你好，这是外部事件监控器的message",
        "dimension_tags": {"heros": "caiwenji"},
        "check_value": 20
    },
    "extraData": {
        "name": "xxxxxxxx"
    }
}
```

> 更多详情，可参考 [外部事件监控器事件接受](../../open-api/checker/receive.md)。

### 步骤二：通知 & 异常追踪

1）**关联异常追踪**：开启关联后，若该监控器下产生了异常事件，将同步创建 Issue。选择 Issue 的等级以及需要投递的目标频道，产生的 Issue 可以前往[异常追踪](../../exception/index.md) > 您选定的[频道](../../exception/channel.md)进行查看。

在事件恢复后，可以同步关闭 Issue。

![](../img/issue-create.png)


2）**告警策略**：所有当前监控器的 Webhook 接收到的事件数据都将应用此告警策略配置。监控满足触发条件后，立即发送告警消息给指定的通知对象。[告警策略](../alert-setting.md)中包含需要通知的事件等级、通知对象、以及告警沉默周期。

### 步骤三：关联

**关联仪表板**：每一个监控器都支持关联一个仪表板，可快速跳转查看。



### 步骤四：权限

设置监控器的操作权限后，您当前工作空间的角色、团队成员以及空间用户将根据分配的权限，对监控器执行相应的操作。这确保了不同用户根据其角色和权限级别进行符合配置的操作。
 
<img src="../../img/monitor_permission.png" width="70%" >


- 不开启该配置：跟随【监控器配置管理】的[默认权限](../management/role-list.md)；
- 开启该配置并选定自定义权限对象：此刻仅创建人和被赋予权限的对象可对该监控器设置的规则进行启用/禁用、编辑、删除操作；
- 开启该配置，但并未选定自定义权限对象：则仅创建人拥有此监控器的启用/禁用、编辑、删除权限。

**注意**：当前工作空间的 Owner 角色不受此处操作权限配置影响。