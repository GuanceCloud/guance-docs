# 告警策略管理
---


观测云支持对监控器的检测结果进行告警策略管理，通过发送告警通知通知，让您及时了解监测的异常数据情况、发现问题、解决问题。

???+ warning "系统默认的告警策略"

    - 每个监控器创建时必须选择一个告警策略，默认选中**默认**；   
    - 当某个告警策略被删除时，删除告警策略下的监控器将自动归类到**默认**下。

## 新建告警策略 {#create}

在观测云工作空间**监控 > 告警策略管理**，点击**新建告警策略**即可添加新的告警策略。可以为告警策略配置告警对象并配置告警聚合。

![](img/monitor2.png)

### 告警名称

即当前告警策略的名称。


### 通知配置

:material-numeric-1-circle-outline: 事件等级：包括<u>紧急、重要、警告、无数据、信息</u>。基于选定的事件等级，观测云支持联动[告警聚合](#pattern)进行告警通知。
    
> 事件等级详情参考 [事件等级说明](monitor/event-level-description.md)。

:material-numeric-2-circle-outline: 通知对象：您可以针对单个异常等级配置通知对象告警通知；通知对象可选择单个或多个。

对象类型如下：

| 对象类型      | 说明      |
| ----------- | ---------------- |
| 空间成员      | 邮件通知，通过在管理 > [成员管理](../management/member-management.md)，添加通知对象。      |
| 团队      | 邮件通知，一个团队可添加多个空间成员，通过在管理 > [成员管理](../management/member-management.md) > 团队管理，添加通知对象。      |
| 邮件组      | 邮件通知，一个邮件组可添加多个团队，通过在监控 > [通知对象管理](notify-object.md)，添加通知对象。      |
| 钉钉机器人、企业微信机器人、飞书机器人      | 群通知，通过在监控 > [通知对象管理](notify-object.md)，添加通知对象。      |
| Webhook 自定义      | 用户自行设定，通过在监控 > [通知对象管理](notify-object.md)，添加通知对象。      |
| 短信      | 短信通知，一个短信组可以添加多个空间成员，通过在监控 > [通知对象管理](notify-object.md)，添加通知对象。观测云免费版无短信通知，其他版本短信通知 0.1 元 / 条，按天计费，没有免费额度。      |

<!--
您可按需选择和添加事件通知等级和告警通知对象，支持<u>不同级别告警到不同的通知对象</u>；  

???+ warning

    - 邮件、钉钉、微信、飞书、短信告警通知都是每分钟合并了发送，并不是产生后立刻发送，会存在约一分钟的延迟； 
    - 邮件、钉钉、微信、飞书收到的告警通知包含“观测云跳转链接”，点击可直接跳转到对应的观测云事件详情，时间范围为当前时间的往前 15 分钟，即 `18:45:00` 的事件，点击链接后跳转至事件详情页，时间范围固定为 `4.20 18:30:00 ~ 4.20 18:45:00`。
-->

**注意**：

- 恢复通知：当历史发送的异常告警事件恢复后，观测云会发送恢复通知到对应通知对象。例如：给某个群发送过相关事件的`紧急`通知，当这一状态开始恢复时，会向此群发送恢复通知。
- 通知延迟：告警通知并非产生后立即发送，会因为数据入库等问题存在最多 1 分钟的延迟。

### 告警聚合 {#pattern}

:material-numeric-1-circle-outline: 不聚合：默认配置；在该模式下，告警事件会按照每 20 秒时间间隔合并为一封通知发送至对应通知对象；

:material-numeric-2-circle-outline: 规则聚合：在该模式下，您可以选择以下四种聚合规则并基于聚合周期来发送告警通知：

<img src="../img/alert.png" width="60%" >

| 聚合规则      | 说明      |
| ----------- | ---------------- |
| 全部      | 基于告警策略配置的等级维度，在所选的聚合周期内生成对应的告警通知。      |
| 监控器 / 智能巡检 / SLO      | 按照监控器、智能巡检的检测规则或 SLO 的唯一 ID，联动聚合周期生成对应的告警通知。      |
| 检测维度      | 按照检测维度联动聚合周期生成对应的告警通知，例如 `host`。      |
| 标签      | 可通过[全局标签](../management/field-management.md)联动[监控器](./monitor/index.md#tags)，并按照聚合周期生成对应的告警通知；标签支持多选。<br />:warning: 若事件同时存在多个标签值，则按照页面配置的标签顺序优先命中到对应的告警通知，多个标签值的关系为 OR。    |


- 聚合周期：在规则聚合的模式下，您可以选择手动设置一个时间范围（1-30分钟内），在这个时间段内新增的事件会被聚合成一条告警通知发送。如果超出这个聚合周期，新增的事件将会被聚合到新的告警通知中。
 
<img src="../img/alert-1.png" width="60%" >


### 告警沉默

若同一个事件不是非常紧急，但是告警通知频率高，可以通过设置重复告警通知的时间间隔这一方式来减少告警通知频率。

**注意**：设置重复告警通知后事件会继续产生，但是告警通知不会再发送，产生的事件会存入事件管理。

<img src="../img/alert-2.png" width="60%" >

## 告警策略列表

告警策略列表保存有当前工作空间内的全部告警策略。您可以查看告警策略名称、关联监控器、告警聚合以及进行其他相关操作。

![](img/monitor12.png)

| 功能 | 说明 |
| --- | --- |
| 查询 | 告警策略列表支持基于告警策略名称进行搜索。 |
| 批量操作 | 您可以选择批量删除特定告警策略。 |
| 关联监控器 | 展示告警策略下的监控器个数，点击个数可以跳转到监控器查看告警策略下的监控器详情。 |
| 告警聚合 | 即显示当前告警策略的聚合方式。 |
| 告警配置 | 点击 :material-bell-cog: 可以修改当前告警策略。 |
| 删除 | 当告警策略被删除时，删除告警策略下的监控器将<u>自动归类到默认</u>下。<br/>您还可以点击名称旁的 :material-crop-square: ，即可选中特定图表批量删除。 |

<!--
## 告警示例

### 1、创建监控器

在**监控**中，新建监控器，点击 **+新建监控器** ，并选择对应检测规则（如：[阈值检测](monitor/threshold-detection.md)），开始配置检测规则。

![](img/monitor10.png)

### 2、配置告警对象

- 添加[告警对象](notify-object.md)

在**管理**，进入**成员管理**，点击**添加成员**，添加成功后，可用于告警通知的对象。

- 配置告警对象

在**监控器**，选择指定告警策略进行**告警配置**，并选择相关通知对象和告警沉默，点击**确定**。

![](img/monitor3.png)

### 3、告警通知

配置完成告警对象后，即可收到告警通知。

![](img/1-alert-1129.png)

**注意**：点击通知内容里的**前往观测云查看**，您可以通过观测云 APP 查看异常事件的详情信息。

> 下载观测云 APP 可以帮助您在移动设备上接收事件的告警通知，更多详情可前往 [移动端](../mobile/index.md)。


### 4、告警事件

在**监控器**，点击**查看相关事件**，即可在 **[事件](../events/index.md)** 查看对应的告警事件列表。
-->