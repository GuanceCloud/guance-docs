# 数据转发至阿里云 OSS
---


## 开始配置

1. 存档类型选择 **阿里云 OSS**，即表示将匹配到的日志数据保存到 OSS 对象存储中；   
2. 选择[访问类型](#type)；
3. 点击**确定**，即可创建成功。

**注意**：若存档类型信息有变动，需确认关联平台的配置已同步更新，从而避免由于配置变化导致数据写入失败的情况。新的配置规则将在 5 分钟内生效。


## 访问类型 {#type}

### 角色授权

![](../img/oss-1.png)

1. 您需使用观测云默认生成的外部 ID 配置角色授权使用。

2. [在阿里云配置台配置授权角色](../aliyun-account.md)后，填写存档信息，填入阿里云账号 ID、OSS 角色名称、地区及 Bucket 名称。

3. 填入[存储路径](#standard)，方便后续进一步区分和查找数据转发的具体位置。

4. 点击**测试连接**，若上述信息满足规范，则提示测试连接成功。点击确定即可保存当前规则。


???+ warning "若未通过测试："

    您需确认：

    - 授权是否成功；  
    - 账号 ID 是否正确；   
    - 存储桶是否存在；  
    - Region 是否不一致。  

    **当出现这种情况时，需谨慎操作：**

    - 若您点击重新生成外部 ID，历史 ID 将于 24 小时后失效，请尽快前往阿里云控制台替换；  
 
    - 不要多次点击生成外部 ID，请谨慎操作！



### Access Keys

![](../img/oss-2.png)

1. 您需在阿里云中[配置观测云 RAM 策略](../aliyun-ram.md)。配置完成后，填写账号信息，输入阿里云 AK & SK、地区及 Bucket 名称。

2. 填入[存储路径](#standard)，方便后续进一步区分和查找数据转发的具体位置。

3. 点击**测试连接**，若上述信息满足规范，则提示测试连接成功。点击确定即可保存当前规则。

???+ warning "若未通过测试："

    您需确认：

    - 账号 ID 是否正确；  
    - AK / SK 是否存在；  
    - 存储桶是否存在；  
    - Region 是否不一致。  

### 账号授权

![](../img/oss-2-1.png)


1. 阿里云提供跨账号授权能力，您需使用观测云专属的账号 ID 并[依据配置说明](../ali-cross-account.md)添加跨账号访问授权策略。

2. 配置完成后，选择地区并输入存储桶名称。

3. 填入[存储路径](#standard)，方便后续进一步区分和查找数据转发的具体位置。

4. 点击**测试连接**，若上述信息满足规范，则提示测试连接成功。点击确定即可保存当前规则。


???+ warning "若未通过测试："

    您需确认：

    - 账号 ID 是否正确；   
    - 存储桶是否存在；  
    - Region 是否不一致。

**关于海外站点**：海外站点的账号 ID 与中国站点不同，请作区分：

| 站点 | ID|
| ---------- | ------------- |
| 中国香港 | 1702505505232494|
| 俄勒冈 | 218475797167922022|
| 新加坡 | 218475797167922022|
| 法兰克福 | 218475797167922022|

#### 目录路径（文件夹）命名规范 {#standard}

1. 创建单个文件夹和多层级文件夹，斜杠（/）表示创建多层级文件夹。  
2. 文件夹名称不能以斜杠（/）开头或结尾。  
3. 不能包含两个以上相邻的斜杠（/）。
4. 适用于所有访问类型。   

**注意**：

- 若填入的文件夹不存在，观测云将直接创建，数据仍会存入该路径下。
- 请谨慎变更存储路径，由于更新配置存在 5 分钟左右的延迟，变更后可能会有部分数据依然转发到原目录下。
