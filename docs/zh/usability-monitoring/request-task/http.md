# 创建 HTTP 拨测任务
---


HTTP 拨测对基于 `HTTP` 协议下的网站、域名、后台接口等进行周期的可用性监测。通过对站点的实时监测，统计其可用情况，提供拨测日志和实时告警，帮助您快速发现网络问题，提高网络访问质量。

HTTP 拨测允许您向应用程序的 API 接口发送 HTTP 请求，以验证定义请求和判断条件，例如请求头、状态码、响应时间等。

## 开始创建

点击**新建 > API 拨测**，选择 **HTTP 协议**。

<img src="../../img/api_test_http.png" width="70%" >


### 1、定义请求格式

1. URL：同时支持输入 HTTP 或者 HTTPS 的 URL，包括四种请求方式 `GET`、`POST`、`PUT` 和 `HEAD`；  
2. 高级设置：根据实际情况进行高级设置，包括请求设置、请求体内容、证书、代理、隐私；  
3. 名称：自定义 HTTP 拨测任务名称，在当前工作空间内不支持重名。

#### 高级设置 {#advanced}


<div class="grid" markdown>

=== "请求设置"

    1. 选择当前 HTTP 请求在执行时是否跟随重定向；
    2. 定义要添加到当前 HTTP 请求中的请求头信息；
    3. 定义要添加到 HTTP 请求中的 Cookie；
    4. 添加 HTTP 认证，包括用户名/密码。
    

=== "请求体内容"

    1. 选择请求体类型：`text/plain`, `application/json`, `text/xml`, `None`；
    2. 输入请求体内容。


=== "证书"

    1. 忽略服务端证书报错：勾选后，表示即使 SSL 证书验证失败，HTTP 测试也会继续执行连接；
    2. 上传客户端证书，包含私钥和证书。


=== "代理"

    1. 指定 HTTP 请求需要通过的代理服务器地址；
    2. 添加需要包含在发送到代理服务器的 HTTP 请求头信息。

=== "隐私"

    不保存响应内容：勾选此选项后，运行时不会保存响应体内容，从而避免敏感数据出现在测试结果中。但请注意，这可能会增加排查问题的难度。


</div>


### 2、可用判断 {#test}

#### 默认模式

即通过添加判断条件来匹配数据。多个条件之间可以选择“所有”或“任意”来实现 AND 或 OR 逻辑关系。

定义好请求格式并添加判断条件后，点击 URL 右侧的“测试”按钮，验证拨测连接配置是否成功。

**注意**：测试结果与选择的节点无关。

#### 脚本模式 {#script}

脚本模式通过编写 Pipeline 脚本，可实现以下功能：

- 设置判断条件：根据业务需求，自定义复杂的判断逻辑，支持单条件或多条件组合判断；
- 处理结果数据：对拨测结果进行自定义处理，包括数据清洗、格式转换等。

脚本模式可灵活满足从响应中提取特定字段或进行复杂条件判断的需求。

示例：

```
body = load_json(response["body"])

if body["code"] == 200 {
  result["is_failed"] = false
} else {
  result["is_failed"] = true
  result["error_message"] = body["message"]
}
```

在脚本中，首先使用 `load_json` 将响应内容解析为 JSON 对象，然后判断响应状态码是否为 200。如果 `code` 为 200，则将结果标记为成功；否则，将 `result` 的 `is_failed` 设置为 `true`，并将 `error_message` 设置为响应内容中的 `message`。

> 更多阅读，可参考 [自定义拨测任务](../../integrations/dialtesting_json.md#post_script)。

### 3、选择拨测节点

目前<<< custom_key.brand_name >>>已覆盖全球 14 个拨测节点。您可以选择中国地区或海外地区（仅限商业版及以上用户）的一个或多个节点，快速开启站点服务质量监测。


### 4、选择拨测频率

选择拨测任务的执行频率，支持以下选项：

- 1 分钟（仅限商业版及以上用户）
- 5 分钟（仅限商业版及以上用户）
- 15 分钟（仅限商业版及以上用户）
- 30 分钟
- 1 小时
- 6 小时
- 12 小时
- 24 小时



