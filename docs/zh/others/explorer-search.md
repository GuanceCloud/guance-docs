# 查看器检索
---

在各个查看器进行数据检索的过程中，我们可以使用多种搜索和筛选方式，例如模糊搜索、关联搜索、正向筛选、反向筛选等等，下面我们进行针对性的详细说明。

## 搜索说明

### 关键字搜索

查看器中支持在搜索栏输入关键字进行检索，查询结果中会对输入的关键字高亮显示，如下图所示。

![](img/13.search_1.png)

### 通配符搜索

查看器中支持输入通配符进行模糊匹配搜索，如在日志搜索栏输入 `global*` ，返回关键字中含“global” 的日志数据， global 后面可以是任意数目的字符，如图所示。

![](img/8.search_2.png)

### 关联搜索

查看器中支持按照 AND/OR/NOT 逻辑进行关联搜索，可以与通配符搜索联合使用。

| 逻辑关系 | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| a AND b  | 返回结果需同时包含a和b，输入的关键字越多，数据匹配的范围就越精准。其中`AND`可以用 `空格` 或者 ` , `代替，即 `a,b` = `a b` = `a AND b` |
| a OR b   | 返回结果需包含 a 或者 b 的任意一个关键字                     |
| NOT c    | 返回结果需要不包含关键字 c                                   |

![](img/13.search_4.png)


###  JSON 搜索

>前提： 工作空间需要在 `2022年6月23日` 后创建

目前 Json 搜索功能只对日志查看器开放，使用说明如下：

- 默认对 message 的内容进行精确检索，同时需要 message 是 json 格式，其他格式的日志内容不支持该检索方式。
- Json 搜索格式为： `@key:value`，若为多层级 json 可用 “.” 承接，即`@key1.key2:value`，如图所示。

![](img/7.log_json.png)

### 字段筛选

在查看器中，可针对 `标签/属性` 进行值的筛选，支持四种筛选方式，分别为：正向筛选、反向筛选、模糊匹配和反向模糊匹配。

- 可通过点击下拉进行筛选，或按规定的格式手动输入标签内容，按回车键进行筛选。
- 正选、反选、模糊匹配和反向模糊匹配分别放在四个标签下拉中，每个标签之间都为 `and` 关系。
- 若某个标签同时有正选和反选两种状态，则在快捷筛选中该标签置灰不可操作。

![](img/5.explorer_search_1.png)

#### 正向筛选

通过 `key:value` 的形式进行正向筛选搜索，例如：在日志查看器中搜索 `status:error` ，即返回所有状态属于 error 的日志数据。

![](img/positive_selection.gif)


#### 反向筛选

通过 `-key:value` 的形式进行反向筛选搜索。例如：在日志查看器中搜索 `-status:info` ，即返回所有状态 **不等于** info 的日志数据。

![](img/reverse_selection.gif)

*手动输入标签内容进行反选*
![](img/reverse_selection2.gif)


#### 模糊匹配（Wildcard Matching）

通过 `*key:value` 的形式进行模糊匹配搜索，value 中可书写通配符进行值匹配。例如：在日志查看器中搜索 `*host:prd-*` ，即返回所有主机名以 `prd-` 开头日志数据。

![](img/wildcard_matching.gif)

*手动输入标签内容进行模糊匹配*
![](img/wildcard_matching2.gif)

#### 反向模糊匹配（Not Wildcard Matching）

通过 `-*key:value` 的形式进行反向模糊匹配搜索，value 中可书写通配符进行值匹配。例如：在日志查看器中搜索 `-*service:k8s*` ，即返回所有服务不以 `k8s` 开头日志数据。支持手动输入标签内容进行反向模糊匹配。

![](img/5.explorer_search_2.png)

#### 编辑筛选

已选标签支持如下两种编辑方式

##### 单击标签

单击标签，在弹出的对话框中可对筛选条件进行修改。（注意：label 标签不支持弹窗编辑）

- 运算方式：  

  - `等于`：即正向筛选，支持下拉选择标签值，或手动输入标签值按回车键确定；
  - `不等于`：即反向筛选，支持下拉选择标签值，或手动输入标签值按回车键确定；
  - `模糊匹配`：即 Wildcard Matching ，支持输入通配符进行模糊匹配搜索，多个值之间用 “,” 分隔开

![](img/edit_filter.png)

##### 双击标签

双击标签，可对单个筛选条件进行手输编辑，不能同时修改多个。如下所示

**[key:value] 单选标签**
![](img/double_click1.png)

**[key:xx项] 多选标签**
![](img/double_click2.png)



## 快捷筛选说明 {#quick-filter}

默认状态下，所有标签值全部勾选，表示未进行任何筛选。

1. 点击标签值前面的复选框，表示「取消」或「选中」该值；
2. 点击右上角的「清空筛选」按钮取消该标签的值筛选；
3. 默认状态下取消勾选前面复选框，表示反选该值，继续取消勾选其他复选框，表示为反向多选；
4. 点击标签值所在行，表示正向单选此值「仅选中此项」，继续勾选其他值的复选框，表示为正向多选；
   ![](img/5.explorer_search_3.png)
5. 当正向单选了某个值时，再次点击该值所在行「取消选中」，取消全部筛选；
   ![](img/5.explorer_search_4.png)

6. 若某个标签同时有正选和反选两种状态，则在快捷筛选中该标签置灰不可操作。

![](img/5.explorer_search_5.png)

7. 若快捷筛选超过 10 个属性值，支持输入文本进行实时搜索，支持点击模糊匹配和反向模糊匹配进行筛选。

   ![](img/5.explorer_search_6.png)



### 自定义筛选字段

在查看器中支持编辑「快捷筛选」添加新的「筛选字段」。支持两种配置方式：空间级筛选项和个人级筛选项。

#### 空间级筛选项


由管理员/拥有者进行配置，点击快捷筛选旁的「设置」按钮，即可配置空间级筛选项，支持新增字段、编辑字段别名、调整字段顺序、删除字段。

注意：空间级筛选项，工作空间所有成员可以查看，但普通成员和标准成员不支持编辑、删除、移动位置。

![](img/5.explorer_search_7.png)



#### 个人级筛选项

所有成员都可以配置基于本地浏览器的快捷筛选项，点击快捷筛选右侧的「编辑」，即可配置个人级筛选项，支持新增字段、编辑字段别名、调整字段顺序、删除字段。

注意：个人级筛选项，仅当前个人可查看，工作空间其他成员无法查看。

![](img/5.explorer_search_8.png)



## 时间组件说明

<<< custom_key.brand_name >>>支持通过时间组件控制当前查看器的数据展示范围，用户可以快速选择当前查看器的内置时间范围，或通过「开始时间」和「结束时间」自定义设置时间范围。

**时间范围**

「快速选择」中预设了多种时间范围，包括相对时间（昨天、上周、上月等）和相近时间（最近15分钟、最近1小时、最近1天等）两种范围类型。

**数据刷新时间**

<<< custom_key.brand_name >>>时间组件数据刷新时间默认为30秒

![](img/4.url_3.png)

点击「暂停」按钮，退出实时数据刷新模式，锁定当前时间范围为绝对时间。

> 例如：时间范围选择了“最近 15 分钟”，那么当点击「暂停」按钮后，查看器的时间范围整体向前调节为 15 分钟

![](img/4.url_4.png)

### URL 的时间范围 {#url}

除了时间控件提供的时间范围选择以外，<<< custom_key.brand_name >>>还支持在浏览器的 URL 中直接修改当前工作空间查看器的 `time` 参数的时间范围进行数据查询，支持秒、分、时、天 4 种单位，如 time=30s、time=20m、time=6h、time=2d 等，如下图所示在浏览器修改 `time=2h` ，查看器展示最近 2 小时的数据。

注意：

- 每种单位只能独立使用，不可组合
- 当选择或者在浏览器输入的时间范围大于等于 1d ，查看器自动停止播放模式。

![](img/4.url_1.png)



