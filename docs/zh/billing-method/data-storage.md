# 数据存储策略
---


随着业务应用程序的增加，数据观测需求范围不断扩大，对不同类型数据的存储时长的需求也会进而随之调整。{{{ custom_key.brand_name }}}提供多种数据存储策略，您可以根据需求自定义您的数据存储时长，从而有效控制数据存储费用，节约成本。

## 数据存储时长

| <div style="width: 200px">类型</div> | 时长 |
| --- | --- |
| 指标 | 即指标全局数据保存策略。如您针对某些指标集有特殊的数据保存时长要求，可通过[配置存储策略](../metrics/dictionary.md)做自定义修改。<br /><br />3 天 / 7 天（默认）/ 14 天 / 30 天 / 180 天 / 360 天 |
| 日志 | 3 天 / 7 天 / 14 天（默认）/ 30 天 / 60 天 |
| 数据转发-{{{ custom_key.brand_name }}} | 180 天（默认）/ 360 天 / 720 天 |
| 事件 | 14 天（默认）/ 30 天 / 60 天 |
| 应用性能-链路 / Profile | 3 天 / 7 天/ 14 天（默认）|
| 用户访问 | 3 天 / 7 天 / 14 天（默认）|
| 安全巡检 | 3 天 / 7 天 / 14 天（默认）/ 30 天 / 60 天 |

### 变更存储时长

商业版工作空间拥有者当天可以多次调整数据存储策略，当天内除第一次修改会立即生效，其他的修改操作将按照最后一次调整记录次日生效。策略变更后，数据将会根据最新配置判断过期范围并在次日 0 点做清除处理。

变更步骤如下：

1. 进入[**管理 > 空间设置 > 变更数据存储策略**](../management/settings/index.md#change)；
2. 点击**更换**；
3. 选择需要修改数据存储策略的数据类型，点击**编辑**；
4. 选择需要修改的时长；
5. 修改完成后，点击**确定**，即可变更当前工作空间内的数据存储时长。

<img src="../img/2.data_storage_2.1.png" width="60%" >

### 变更须知

1. 只允许商业版工作空间拥有者进行此操作；  
2. 指标数据存储策略变更后，旧的存储策略里面的数据将会被删除，请谨慎选择。
3. 除指标数据以外的其他数据存储策略变更后，新的保存策略即时生效，旧的存储策略里面的数据不会立即删除，在策略滚动删除旧数据之前仍然存在这部分计费。

    - 数据保存时间缩短：假设应用性能数据从 14 天调整为 7 天，以当天调整的时间为分界线，在此之前的数据仍然按照 14 天存储策略计算费用，在此之后的数据会生成新的索引并按照新的 7 天存储策略计算费用；
    - 数据保存时间变长：假设应用性能数据从 7 天调整为 14 天，以当天调整的时间为分界线，在此之前的数据仍然按照 7 天存储策略计算费用，在此之后的数据会生成新的索引并按照新的 14 天存储策略计算费用。
        
> 更多详情，可参考 [{{{ custom_key.brand_name }}} ES 多租户生命周期管理实践](../billing-method/es-life-cycle.md)。


## 数据存储方式 {#options}

{{{ custom_key.brand_name }}}提供两种数据存储方案：**默认存储**和 **SLS 存储**：

- 默认存储：使用{{{ custom_key.brand_name }}} [GuanceDB](./gauncedb.md) 存储指标类数据，Elasticsearch / OpenSearch 存储日志类数据；
- SLS 存储：使用阿里云日志服务 SLS 存储数据，日志库（LogStore）存储日志类数据，时序库（MetricStore）存储指标类数据。


### 针对体验版 {#free}

#### 计费须知

1. 体验版不同计费项目若存在数据额度使用满载的情况，数据将停止上报更新；基础设施、事件这两类数据依旧支持上报更新，您仍可以看到基础设施列表数据，事件数据；     
2. 体验版支持在线升级到商业版，不升级则不收费，一旦升级到付费版本，不可回退；        
3. 体验版升级到商业版后，采集数据会继续上报到{{{ custom_key.brand_name }}}工作空间，但是体验版时期采集的数据将无法查看；   
4. 时间线和数据转发统计的是全量数据，其他计费项都为增量数据；增量数据统计每天 0 点重置免费配额，当天有效。   

{{{ custom_key.brand_name }}}支持免费开始，按需购买，按量付费的计费方式，为您提供开箱即用，实现全面观测的云平台。{{{ custom_key.brand_name }}}体验版提供 7 天的数据存储策略，若您需要变更数据存储策略，需[升级到{{{ custom_key.brand_name }}}商业版](../plans/trail.md#upgrade-commercial)后进行变更。

| <div style="width: 160px">**计费项**</div>             | **体验额度**  | <div style="width: 160px">**数据存储策略**</div> | **备注**                                                     |
| ---------------------- | ------------- | ---------------- | ------------------------------------------------------------ |
| 时间线数量             | 3000 条       | 7 天             |                                                              |
| 日志类数据数量         | 每天 100 万条 | 7 天             | 数据范围：事件、安全巡检、日志(不含可用性监测的日志数据) |
| 数据转发数据数量       | /             | /                | ❌                                     |
| 应用性能 Trace 数量    | 每天 8000 个  | 7 天             |                                                              |
| 应用性能 Profile 数量    | 每天 60 个  | 7 天             |                                                              |
| 用户访问 PV 数量       | 每天 2000 个  | 7 天             |                                                              |
| 会话重放 Session 数量       | 每天 1000 个  | 7 天             |                                                              |
| 可用性监测拨测任务次数 | 每天 20 万次  | 7 天             |                                                              |
| 任务调用次数           | 每天 10 万次  | /                |                                                              |
| 短信发送次数           | /             | /                | ❌                                         |



