# 中国地图
---

## 简介

“观测云” 支持向视图中添加中国地图。

## 应用场景

观测云的世界地图用于显示某个指标数据在不同省份的数据分布情况。可用于以下场景：

- 展示不同区域的数据分布情况
- 显示不同区域的数据大小排名

## 图表查询

**前提条件:** 指标查询的数据集中必须包含表示“省份”的标签，并且查询条件中必须包含“省份”的分组，否则图表无法添加成功

图表查询条件详细说明请点击 [图表查询](chart-query.md) 进行查看，默认添加简单查询。可以添加多个查询，但 by（分组）的 Tag 必须一致，修改一个，另外的自动同步修改。

图表查询通过省份匹配地区，通过指标值匹配颜色，具体说明如下：

| 选项 | 说明 |
| --- | --- |
| 省份标签 | 选择表示省份的标签，该标签必须为查询中已分组的 tag 标签（**注意：省份标签的标签名不一定非要是“省份”，只要值是省级行政区就可以了**） |
| 指标 | 当添加了多个指标查询时，可设置主要展示的指标。“主展示指标”决定色块渐变色的指标 |

## 图表链接

链接可以帮助你实现从当前图表跳转至目标页面，支持添加平台内部链接和外部链接，支持通过模板变量修改链接中对应的变量值将数据信息传送过去，完成数据联动。相关设置说明请点击 [图表链接](chart-link.md) 进行查看。
## 图表样式
| 选项 | 说明 |
| --- | --- |
| 图表标题 | 为图表设置标题名称，设置完成后，在图表的左上方显示，支持隐藏 |
| 地区排名 | 支持依据地区的数据的大小排名，自大到小。默认关闭 |
| 颜色 | 1.渐变色系：色块的渐变色。选择颜色后，系统将以所选颜色为基准，生成所选等级数量的颜色色块<br/>2.渐变区间：<br/><li>自动：默认按照当前数据的最大值、最小值平分为 5 个区间，支持自定义最大值和最小值；<br/><li>自定义：支持自定义渐变色系等级，即地图中区域范围的等级设置。系统默认将所选指标的最大值和最小值平分为 5 个渐变等级，支持自定义等级数量（最大 10 个）、等级范围以及显示颜色 |


## 图表设置

### 基本设置
| 选项 | 说明 |
| --- | --- |
| 单位 | 1.支持为查询结果设置单位。<br />1）若查询的数据无单位，在图表设置单位后，按照设置的单位在图表上展示<br />2）若查询的数据自带单位，或者您在 [指标管理](../../metrics/dictionary.md) 中为指标设置了单位，并在图表设置单位后，按照在图表设置的单位在图表上展示<br />3）若查询的数据无单位，且在图表不设置单位，则按照科学计数自动计算图表Y轴数值；按照 [千分位](chart-query.md#thousand) 的格式在图表上展示原始数值。<br /> **科学计数说明**<br />默认查询结果值自动转换单位，展示遵循「科学计数 K、M、B」（1千 = 1K，100万 = 1M，10亿 = 1B），保留两位小数点；人民币自动转换单位「元、万、亿」，保留两位小数点<br />*例如：单位的时间间隔选择单位为 ns，那么按照数据的大小，查询结果只自动转换单位效果如下，以此类推：*<br /><li>1000000ns：图表查询数据结果显示为1ms<br /><li>1000000000ns：图表查询数据结果显示为1s<br /><li>10000000000ns：图表查询数据结果显示为1m<br /><br/>2.支持为查询结果预设单位，手动输入格式为：聚合函数(指标)，如 `last(usage_idle)` |

### 高级设置
| 选项 | 说明 |
| --- | --- |
| 时间分片 | 开启时间分片后，会先对原始数据按照一定的时间间隔进行分段聚合，再对聚合后数据集进行第二次聚合得到结果值，默认关闭。详情可参考 [时间分片说明](chart-query.md#time-slicing) |
| 锁定时间 | 支持锁定图表查询数据的时间范围，不受全局时间组件的限制。设置成功后的图表右上角会出现用户设定的时间，如【xx分钟】、【xx小时】、【xx天】。如锁定时间间隔30分钟，那么当调节时间组件无论查询什么时间范围视图，仍只会显示最近 30 分钟数据 |
| 时间间隔 | 若时间分片关闭，无时间间隔选项，若时间分片开启，时间间隔选项如下：<br /><li>原始间隔：根据时间组件的时间范围默认查询显示数据<br /><li>自动对齐：开启后，将按选择的时间范围和聚合时间间隔动态的调整查询，根据计算的时间间隔就近向上取整。（ 例如：自动聚合算法计算出时间间隔是 50 秒，那么实际将按照  1 分钟的时间间隔发起查询 ）系统预设了1毫秒、10毫秒、50毫秒、100毫秒、500毫秒、1秒、5秒、15秒、30秒、1分钟、5分钟，10分钟、30分钟、1小时，6小时，12小时、1天、1周、1月，多种时间间隔。<br /><li>自定义时间间隔：当选择【锁定时间】时，根据锁定时间的长短，自动匹配不同的可选时间间隔查询显示数据。（ 例如：时间间隔选择 1 分钟，那么实际将按照  1 分钟的时间间隔发起查询 ）<br /> |
| 字段映射 | 配合视图变量的对象映射功能，默认为关闭，若在视图变量已配置对象映射：<br /><li>开启字段映射时，图表显示查询的「分组字段」和对应的「映射字段」，未指定映射的分组字段不显示<br /><li>关闭字段映射时，图表正常显示，不显示映射的字段<br /> |
| 图表联动 | 地图与视图变量联动。开启后，选择要联动的视图变量，则当点击地图色块区域时，视图变量值自动变为所选的区域值 |
| 图表说明 | 为图表添加描述信息，设置后图表标题后方会出现【i】的提示，不设置则不显示 |
| 工作空间 | 被授权的工作空间列表，选择后即可通过图表查询并展示该工作空间数据 |

## 示例图

下图为新冠疫情各省份康复出院人数示例。

![](../img/zhongguo.png)

注意：此图表数据仅为测试数据。

