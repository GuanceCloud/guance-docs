# Trace Explorer

---

After successfully collecting data, you can view all related data on the trace functionality page. Using the [powerful search function](../../getting-started/function-details/explorer-search.md#search), you can easily filter and view trace data for any time period, quickly identifying and locating abnormal traces.

The [flame graph](#flame) provides an intuitive view to observe the flow and performance of each Span in the trace. Additionally, Guance's tagging feature allows you to automatically associate infrastructure, logs, RUM, and other data with trace analysis, supporting code-level data correlation, helping you quickly locate and resolve issues. Tools such as [Span List](./explorer-analysis.md#span), [Waterfall Chart](./explorer-analysis.md#waterfall), etc., further display Span information related to a specific trace.

## Trace List

Guance provides three types of trace lists: **All Spans**, **Service Entry Spans**, and **All Traces**.

A Span represents a logical unit of work within a distributed system over a given time period, and multiple Spans form a trace trajectory (`trace`).

<div class="grid" markdown>

=== "All Spans"

    Displays all Span data collected within the selected time range.

    ![](../img/4.apm_1.png)

=== "Service Entry Spans"

    Filters and displays Spans generated by service entry calls within the selected time range.

    ![](../img/4.apm_2.png)

=== "All Traces"

    Filters and displays top-level entry Spans for all trace calls within the selected time range.

    ![](../img/4.apm_3.png)

</div>

## Query and Analysis

- **Time Control:** The Trace Explorer defaults to displaying data from the past 15 minutes, but you can also customize the [time range](../../getting-started/function-details/explorer-search.md#time).

- In the Trace Explorer search bar, it supports [various search methods and filtering methods](../../getting-started/function-details/explorer-search.md).

  - **Note:** When switching between **Service** or **Trace** Explorers, Guance retains your current filtering conditions and time range by default.

- **Analysis Mode:** In the Trace Explorer [analysis panel](../../getting-started/function-details/explorer-search.md#analysis), you can perform multi-dimensional analysis based on <u>1-3 tags</u> and support various data chart analysis methods.

- **Quick Filter:** Supports editing [quick filters](../../getting-started/function-details/explorer-search.md#quick-filter) and adding new filtering fields.

- **Filter History:** Guance supports saving `key:value` search condition history for different Explorers in the current workspace via [filter history](../../getting-started/function-details/explorer-search.md#filter-history).

- **Customize [Display Columns](../../getting-started/function-details/explorer-search.md#columns):** By default, the trace list displays **Time**, **Trace ID**, **Service**, **Resource**, and **Duration**. You can customize, add, edit, delete, and drag display columns.

- Guance supports **viewing historical snapshots** to directly save snapshot data of the current Explorer. Through the [snapshot](../../getting-started/function-details/snapshot.md) feature, you can quickly reproduce instant copies of the data and restore it to a certain point in time and data display logic.

### Chart Statistics

In the Trace Explorer chart statistics, you can view the number of requests, **Error Requests**, and **Response Time** for different states within the selected time range. You can synchronize and display chart statistics through filtering.

- Number of Requests/Error Requests: Divided into 60 time points based on the selected time range, displayed using a bar chart to show the number of requests and error requests.
- Response Time: Divided into 60 time points based on the selected time range, displayed using a line chart to show four response metrics: average response time per second, P75 response time, P90 response time, and P99 response time.

### Trace Data Export

In the Trace Explorer, after filtering and analyzing the desired trace data, you can export it to CSV files or scene dashboards and notes.

If you need to export a specific data item, open its details page and click the :material-tray-arrow-up: icon in the upper right corner.

<img src="../../img/3.apm_6.png" width="70%" >

## Trace Details {#detail}

In the Trace Explorer, you can click any trace to view its details, including relative time, duration, HTTP method, HTTP URL, HTTP status code, TraceId, flame graph, Span list, service call relationships, and associated logs, hosts, metrics, network, etc.

![](../img/9.apm_explorer_6.1.png)

If the current trace belongs to a frontend application (e.g., browser), you can view request latency distribution in the trace details, including Queueing (queue), First Byte (first packet), Download (download) request latency ratios.

**Note:** The flame graph/Span list/waterfall chart can display up to 10,000 Spans. You can use the **offset** setting to view unshown Spans:

![](../img/flame-offset.png)

???+ warning

    The RUM SDK must be version 2.2.10 or higher to see this data. If there is a cross-origin situation, header configurations need to be adjusted.

    > For more details, refer to [Web Application Integration](../../real-user-monitoring/web/faq.md#header).

<img src="../../img/11.apm_browse_1.png" width="70%" >

### Flame Graph {#flame}

The flame graph clearly displays the flow and execution time of each Span in the entire trace. You can view the corresponding service list and response times on the right side of the flame graph. Clicking a Span in the flame graph will display its JSON content in the **Trace Details**, and you can zoom in to view specific Span information using the mouse scroll wheel.

> For more detailed applications of flame graphs, refer to [Using Flame Graphs to Analyze Trace Performance](../../best-practices/monitoring/trace-flame-graph.md).

<div class="grid" markdown>

=== "Flame Graph Trace Explanation"

    ![](../img/13.apm_flame.png)

    From the flame graph above, this call trace includes two services, namely <u>CloudCare and Mysql</u>. The trace starts with a POST request initiated by the CloudCare service, then executes `ActionResource.executeAction`, and finally executes Mysql statements. During the entire process of executing `ActionResource.executeAction`, Mysql statements are executed multiple times. The execution times for CloudCare and Mysql services are calculated as follows:

    - Execution time for CloudCare service = D1+D2+D3+D4+D5+D6+D7+D8+D9+D10+D11
    - Execution time for Mysql service = span2+span3+......+span11

    ![](../img/span_2.png)

    Specific execution statements and execution times can be referenced in the Span list.

=== "Execution Time Ratio Calculation Explanation"

    The execution time ratio of services in the flame graph refers to the proportion of each service's execution time out of the total time for this call trace. As shown in the figure below, this call trace includes two services, CloudCare and Mysql, with execution time ratios of 42.37% and 57.63%, respectively. CloudCare service has 2 Spans, and Mysql service has 10 Spans.

    - Execution time ratio calculation for Mysql service: Sum of all span execution times / total duration of the current call trace.

    Calculation explanation: In the figure below, Mysql service has a total of 10 Spans. You can click each Span to obtain its execution time. From the figure, it can be seen that the execution time for this Span is 5.08ms. Similarly, obtain the execution times of the remaining 9 Spans and sum them up.

    ![](../img/13.apm_flame_0.1.png)

    - Execution time ratio calculation for CloudCare service: (Total duration of the current call trace - Mysql service execution time) / total duration of the current call trace.

    Calculation explanation: In the figure below, CloudCare service spans the entire call trace except for the execution time of the Mysql service. The remaining time is the execution time for the CloudCare service (see the red line marked part). The execution time ratio can also be viewed directly through the Span list.

    ![](../img/13.apm_flame.png)

=== "Asynchronous Calls"

    In the flame graph, whether the service calls are synchronous or asynchronous, you can clearly track the performance data of each trace. For example, through the flame graph, you can clearly see which requests are asynchronous, their start time, end time, and total time spent.

    ![](../img/9.apm_explorer_19.2.png)

</div>

### Span List {#span}

Displays the Span list and total number of Spans for this trace, including **resource name**, **number of Spans**, **duration**, **execution time**, and **execution time ratio**.

You can input the resource name or Span ID to search for matches. Clicking any Span will display its corresponding JSON content in the **Trace Details**, and switching to the flame graph will sync the Span display. If there are errors, an error message will be shown.

Clicking **Error Spans** will directly display the filtered results.

![](../img/9.apm_explorer_18.png)

### Waterfall Chart {#waterfall}

View the parent-child relationships between resources.

The waterfall chart displays Span data in chronological order. On the left side, Span data is listed, showing the execution time ratio for each resource. On the right side, the waterfall chart is displayed according to the sequence of events.

- You can input the resource name or Span ID to search for matches;

- Click :octicons-arrow-switch-24: to toggle the format of execution time;

- Click **Error Spans** to directly display the filtered results.

![](../img/0710-span.gif)

### Service Call Relationship {#call}

Used to view the call relationship between services and directly display the number of calls. You can search and filter related service call relationships through services, resources, and Span IDs.

Guance displays the color of services here based on the `error` results from the [flame graph](#flame) statistics for the corresponding service. If a service appears red, it indicates that there is an error.

![](../img/9.apm_explorer_9.gif)

If you configure a `service` [binding](../../scene/built-in-view/bind-view.md#bind) relationship in the user view, such as `service:mysql`, clicking the service card will quickly take you to the related user view.

Clicking a view will redirect you to its detail page.

![](../img/apm_explorer_view.png)

### Quick Actions {#icon}

| <div style="width: 160px">Action</div> | Description                                                                                                                                                           |
| ------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Full-screen View/Restore Default Size | Click the full-screen view icon :material-arrow-expand-all: in the upper-right corner of the trace details to expand the flame graph horizontally; click the restore default size icon :material-arrow-collapse-all: to return to the default size. |
| Expand/Collapse Mini Map             | Click the expand/collapse mini map icon :material-format-indent-increase: on the left side of the trace details to quickly view the flame graph by selecting intervals, dragging, or scrolling on the mini map.                              |
| View Global Trace                    | Click the view global trace icon :material-arrow-expand: on the left side of the trace details to view the global trace in the flame graph.                                                                      |
| Double-click Span                    | Double-click a Span in the middle of the flame graph to zoom in and view its context-related Spans.                                                                                             |
| Click Service Name                   | Highlight the corresponding Span, and click the service name again to restore the default selection of all Spans. You can quickly filter and view Spans related to the service by clicking the service name.                                                  |

![](../img/10.changelog_apm.gif)

### Extended Attributes

:material-numeric-1-circle-outline: In the search bar, you can input field names or values for quick search and location;

:material-numeric-2-circle-outline: After checking the alias, you can view it after the field name. Choose as needed.

:material-numeric-3-circle-outline: In the trace details page, you can view relevant field attributes of the current trace in the **Extended Attributes** section:

| <div style="width: 120px">Field</div> | Attribute                                                                                                           |
| ------------------------------------ | -------------------------------------------------------------------------------------------------------------- |
| Filter Field Value                   | Adds the field to the Explorer to view all related data, allowing you to filter and view related trace lists in the trace Explorer.<br />_See Figure 1._ |
| Exclude Field Value                  | Adds the field to the Explorer to view all data except for the specified field.                                                           |
| Add to Display Columns               | Adds the field to the Explorer list for viewing.                                                                             |
| Copy                                 | Copies the field to the clipboard.                                                                                         |

![](../img/extension.png)

???- abstract "Some Fields Do Not Support Filtering and Aggregation Logic"

    Some fields in Guance use full-text indexing and do not support filtering, aggregation, and related logic. The full-text indexed fields include:

    | Category      | Field                  |
    | ----------- | ------------------ |
    | Objects, Resource Catalog      | `message `                 |
    | Logs, Backup Logs      | `message`                  |
    | Security      | `message` / `title`                  |
    | Network      | `message`                  |
    | Trace      | `error_message` / `error_stack`                  |
    | Events      | `message` / `title` / `df_message` / `df_title`                  |
    | RUM Errors      | `error_message` / `error_stack`                  |
    | RUM Long Tasks      | `long_task_message` / `long_task_stack`                  |

<font size=2>_Figure 1_</font>

![](../img/9.apm_explorer_8.png)

### Error Details

On the trace details page, if there are error traces, you can view related error details.

> For more error trace analysis, refer to [Error Tracking](../error.md).

![](../img/6.apm_error.png)

### Associated Analysis

<div class="grid" markdown>

=== "Associated Logs"

    You can view logs associated with the current trace (association field: `trace_id`). You can customize display columns. To view more detailed log content, click the log content to go to the log details page, or click the jump button to open the log page.

    ![](../img/3.apm_7.png)

    If you have administrator or higher permissions, you can customize the association fields. Click the settings button next to the association field, choose the fields you want to associate in the pop-up dialog box, and confirm the configuration.

    ![](../img/3.apm_8.png)

    **Note:** Customizing log association fields and service list associated analysis configuration fields affect each other. If custom fields are configured in the service list, they will be displayed here synchronously.

=== "Code Hotspots"

    When the application uses ddtrace collector and enables both APM trace tracking and Profile performance tracking data collection, Guance provides Span-level associated viewing and analysis. In the trace details page, you can click **Code Hotspots** below the flame graph to view the associated code hotspots, including execution latency, methods, and execution time ratios.

    ![](../img/9.apm_explorer_11.png)

    Click **View Profile Details** to navigate to the Profile details page for more associated code.

    ![](../img/9.apm_explorer_12.png)

=== "Associated Hosts"

    In the trace details page, you can view the metric and attribute views of related hosts (association field: `host`).

    - Metric View: View the performance metrics status of related hosts **from 30 minutes before the end of the trace to 30 minutes after the end of the trace**, including CPU, memory, and other performance metrics views of the host.

    ![](../img/3.apm_9.png)

    - Attribute View: Helps you backtrack the actual state of the host object when the trace was generated, supporting viewing the latest object data produced by the host within the corresponding time frame, including basic host information, integration runtime status. If cloud host collection is enabled, you can also view cloud provider information.

    **Note:** Guance saves the most recent 48 hours of host object historical data by default. If no host historical data corresponding to the current trace time is found, you will not be able to view the attribute view of the associated host.

    ![](../img/3.apm_10.png)

=== "Associated Containers"

    In the trace details page, you can view the metric and attribute views of related containers (association field: `container_name`).

    - Metric View: View the performance metrics status of related containers **from 30 minutes before the end of the trace to 30 minutes after the end of the trace**, including container CPU, memory, and other performance metrics views.

    - Attribute View: Helps you backtrack the actual state of the container object when the trace was generated, supporting viewing the latest object data produced by the container within the corresponding time frame, including basic container information and attribute information.

=== "Associated Pods"

    In the trace details page, you can view the attribute and metric views of related Pods (association field: `pod_name`).

    - Metric View: View the performance metrics status of related Pods **from 30 minutes before the end of the trace to 30 minutes after the end of the trace**, including container CPU, memory, and other performance metrics views.

    - Attribute View: Helps you backtrack the actual state of the Pod object when the trace was generated, supporting viewing the latest object data produced by the Pod within the corresponding time frame, including basic Pod information and attribute information.

=== "Associated Network"

    Guance supports viewing multi-dimensional [network topology and overview data](../../infrastructure/network.md) including Host, Pod, Deployment, and Service.

    ![](../img/7.host_network_2.png)

    **Matching Fields:**

    To view related networks in the details page, matching fields need to be configured during data collection. Otherwise, you cannot match and view associated network views in the details page.

    - Host: Matching field `host`.

    - Pod:

    | **Matching Field Priority**  |
    | ------------------- |
    | namespace、pod_name |
    | namespace、pod      |
    | pod_name            |
    | pod                 |

    - Deployment:

    | **Matching Field Priority**  |
    | ------------------- |
    | namespace、deployment_name |
    | namespace、deployment      |
    | deployment_name            |
    | deployment                 |

    - Service:

    | **Matching Field Priority**  |
    | ------------------- |
    | namespace、service_name |
    | namespace、service      |

    **Note:**

    - If Host, Pod, Deployment, and Service association fields are matched simultaneously, the network data is displayed in this order upon entering the details page;
    - If no association fields are matched, they are displayed at the bottom in gray, and clicking prompts **No Network View Matched**.

</div>

## Further Reading

<font size=2>

<div class="grid cards" markdown>

- [<font color="coral"> :fontawesome-solid-arrow-right-long: &nbsp; **Start Collecting Trace Data**</font>](./index.md)

</div>

<div class="grid cards" markdown>

- [<font color="coral"> :fontawesome-solid-arrow-right-long: &nbsp; **Power of the Explorer**</font>](../../getting-started/function-details/explorer-search.md)

</div>

<div class="grid cards" markdown>

- [<font color="coral"> :fontawesome-solid-arrow-right-long: &nbsp; **Bind Built-in Views**</font>](../../scene/built-in-view/bind-view.md#bind)

</div>

</font>