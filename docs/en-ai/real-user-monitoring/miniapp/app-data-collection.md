# Mini Program Application Data Collection
---

After collecting application data to Guance, you can perform custom configuration scenarios and configure anomaly detection events through the Guance console.

## Data Types

Guance's RUM includes six types of data:

| Type | Description |
| --- | --- |
| `session` | Records user session information. During the current session, data related to user pages, resources, actions, errors, and long tasks will be recorded based on the session dimension. |
| `view` | When a user visits a page, a page view record is generated. If the user stays on the same page, resource, long task, error, and action records are linked to the relevant RUM view via the `view_id` attribute. |
| `resource` | Records the resources loaded when a user visits a page. |
| `error` | Collects all front-end errors from the browser. |
| `long_task` | For any task blocking the main thread in the browser for more than 50ms, a long task record is generated. |
| `action` | Tracks all user interactions during page browsing. |

## Global Properties

Scenarios for RUM and event alerts can be queried using the following global properties.

### SDK Properties

| Field | Type | Description |
| --- | --- | --- |
| `sdk_name` | string | Collector name, fixed names:<br>`df_web_rum_sdk`<br>`df_miniapp_rum_sdk`<br>`df_ios_rum_sdk`<br>`df_android_rum_sdk` |
| `sdk_version` | string | Collector version information |

### Application Properties

| Field | Type | Description |
| --- | --- | --- |
| `app_id` | string | Required, unique ID for the monitored application, automatically generated when creating monitoring in the Guance console. |
| `env` | string | Required, environment field. Possible values: prod/gray/pre/common/local. Where:<br>prod: Production environment<br>gray: Gray release environment<br>pre: Pre-release environment<br>common: Daily environment<br>local: Local environment |
| `version` | string | Required, version number. |
| `app_launch_query` | string | Query parameters used to launch the mini program. |
| `app_launch_referrer_info` | string | Referrer information. Returned when entering the mini program from another mini program, official account, or app. |

> For more details, refer to [Field Descriptions](https://developers.weixin.qq.com/miniprogram/dev/api/base/app/life-cycle/wx.getLaunchOptionsSync.html).

### User & Session Properties

| Field | Type | Description |
| --- | --- | --- |
| `userid` | string | For unlogged users, use cookie as userid; for logged-in users, use the user id generated by the application backend. |
| `session_id` | string | Session ID. |
| `session_type` | string | Session type. Reference values: user & synthetics<br>user: Data generated by RUM functionality;<br>synthetics: Data generated by headless Synthetic Tests. |
| `is_signin` | boolean | Whether the user is registered, attribute value: True / False. |

### Device & Resolution Properties

| Field | Type | Description |
| --- | --- | --- |
| `device` | string | Mobile device manufacturer |
| `model` | string | Mobile device model |
| `device_uuid` | string | Unique mobile device ID |
| `os` | string | Operating system information |
| `os_version` | string | Operating system version |
| `os_version_major` | string | Major operating system version |
| `screen_size` | string | Screen resolution |

### Geographic & Network Properties

| Field | Type | Description |
| --- | --- | --- |
| `ip` | string | User IP address |
| `isp` | string | ISP provider |
| `network_type` | string | Network connection type, reference values:<br>wifi & 2g & 3g & 4g & 5g & unknown (unknown network) & unreachable (network unavailable) |
| `country` | string | Country |
| `country_iso_code` | string | Country ISO code |
| `province` | string | Province |
| `city` | string | City |

### Platform & Library Version Properties

| Field | Type | Description |
| --- | --- | --- |
| `platform` | string | Platform of the mini program, e.g., WeChat mini program's platform is `wechat` |
| `platform_version` | string | Version of the app platform hosting the mini program |
| `app_framework_version` | string | Base version library of the mini program |

## Custom Properties

In addition to global properties, custom properties (supported by **SDK for tagging custom data**) can be used to build scenarios and configure event alerts. Custom properties are non-global attributes that allow tracking the entire process of user access to the application, identifying and discovering affected user visits, and monitoring user access performance.

## Other Data Type Attributes

### Session 

#### Properties

| Field                      | Type   | Description                                                         |
| ------------------------- | ------ | ------------------------------------------------------------ |
| `session_id`              | string | Session ID                                                       |
| `session_type`            | string | Session type. Reference values: user & test<br>user: Data generated by RUM functionality;<br>test: Data generated by headless Synthetic Tests. |
| `session_referrer`        | string | Session referrer; usually records the source page URL                         |
| `session_first_view_id`   | string | The `view_id` of the first page in the current session                               |
| `session_first_view_name` | string | Name of the first page in the current session                                   |
| `session_last_view_id`    | string | The `view_id` of the last visited page in the current session                          |
| `session_last_view_name`  | string | Name of the last page in the current session                                 |

#### Metrics

| Field | Type | Description |
| --- | --- | --- |
| `time_spent` | number(ns) | Duration of the current session |
| `session_view_count` | number | Number of associated `view_id`s in the current session |
| `session_error_count` | number | Number of errors in the current session |
| `session_resource_count` | number | Number of resources loaded in the current session |
| `session_action_count` | number | Number of user actions in the current session |
| `session_long_task_count` | number | Number of long tasks in the current session |

### View 

#### Properties

| Field        | Type | Description                                            |
| --------------- | -------- | --------------------------------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited                          |
| `view_referrer` | string   | Page referrer                                            |
| `view_name`     | string   | Page URL                                             |

#### Metrics

| Field | Type | Description |
| --- | --- | --- |
| `loading_time` | number(ns) | Page loading time |
| `first_paint_time` | number(ns) | First paint time<br>Calculation method: onShow (first page) - onLaunch (app) |
| `time_spent` | number(ns) | Time spent on the page |
| `onload_to_onshow` | number(ns) | Time from page onload to onshow |
| `onshow_to_onready` | number(ns) | Time from page onshow to onready |
| `onready` | number(ns) | Page onready time |
| `setdata_duration` | number(ns) | Total duration of `set_data` calls (sum of all setedate durations under one `view_id`) |
| `is_active`     | boolean  | Whether the user is still active, reference values: true & false |

#### Statistical Metrics

| Field | Type | Description |
| --- | --- | --- |
| `view_error_count` | number | Number of errors during each page load |
| `view_resource_count` | number | Number of resources requested during each page load |
| `view_long_task_count` | number | Number of long tasks during each page load |
| `view_action_count` | number | Number of operations during page viewing |
| `view_setdata_count` | number | Number of `set_data` calls during page viewing |
| `view_apdex_level` | number | Page first paint time |

### Resource

#### View Properties

| Field        | Type | Description                                            |
| --------------- | -------- | --------------------------------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited                          |
| `view_referrer` | string   | Page referrer                                            |
| `view_name`     | string   | Page URL                                             |

#### Resource Properties

| Field                  | Type | Description                 |
| ------------------------- | -------- | ------------------------ |
| `resource_url`            | string   | Resource URL                  |
| `resource_url_host`       | string   | Domain part of the resource URL         |
| `resource_url_path`       | string   | Path part of the resource URL         |
| `resource_url_query`      | string   | Query part of the resource URL        |
| `resource_url_path_group` | string   | Grouped path part of the resource URL         |
| `resource_type`           | string   | Category of the resource               |
| `resource_method`         | string   | Resource request method             |
| `resource_status`         | string   | Status code returned by the resource request     |
| `resource_status_group`   | string   | Grouped status code returned by the resource request |

#### Metrics

| Field | Type | Description |
| --- | --- | --- |
| `resource_size` | number | Resource size, default unit: byte |
| `resource_dns` | number(ns) | DNS lookup time for resource loading<br>Calculation method: domainLookupEnd - domainLookupStart |
| `resource_tcp` | number(ns) | TCP connection time for resource loading<br>Calculation method: connectEnd - connectStart |
| `resource_ssl` | number(ns) | SSL connection time for resource loading<br>Calculation method: connectEnd - secureConnectStart |
| `resource_ttfb` | number(ns) | Time to first byte for resource loading<br>Calculation method: responseStart - requestStart |
| `resource_trans` | number(ns) | Content transfer time for resource loading<br>Calculation method: responseEnd - responseStart |
| `resource_first_byte` | number(ns) | First byte time for resource loading<br>Calculation method: responseStart - domainLookupStart |
| `duration` | number(ns) | Total resource loading time<br>Calculation method: duration(responseEnd-startTime) |

### Error

#### View Properties

| Field        | Type | Description                                            |
| --------------- | -------- | --------------------------------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited                          |
| `is_active`     | boolean  | Whether the user is still active, reference values: true & false |
| `view_referrer` | string   | Page referrer                                            |
| `view_name`     | string   | Page URL                                             |

#### Error Properties

| Field                  | Type | Description                                                     |
| ------------------------- | -------- | ------------------------------------------------------------ |
| `error_source`            | string   | Error source, reference values: console & network & source & custom |
| `error_type`              | string   | Error type, reference link: [error type](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error) |
| `resource_status`         | string   | Status code returned by the resource request                                         |
| `resource_url`            | string   | Resource URL                                                      |
| `resource_url_host`       | string   | Domain part of the resource URL                                             |
| `resource_url_path`       | string   | Path part of the resource URL                                             |
| `resource_url_path_group` | string   | Grouped path part of the resource URL                                             |
| `resource_method`         | string   | Resource request method                                                 |

#### Metrics

| Field | Type | Description |
| --- | --- | --- |
| `error_message` | string | Error message |
| `error_stack` | string | Error stack trace |

### Long Task

#### View Properties

| Field        | Type | Description                                            |
| --------------- | -------- | --------------------------------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited                          |
| `is_active`     | boolean  | Whether the user is still active, reference values: true & false |
| `view_referrer` | string   | Page referrer                                            |
| `view_name`     | string   | Page URL                                             |

#### Metrics

| Field | Type | Description |
| --- | --- | --- |
| `duration` | number(ns) | Time spent on long tasks during page loading |

### Action

#### View Properties

| Field        | Type | Description                                            |
| --------------- | -------- | --------------------------------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited                          |
| `is_active`     | boolean  | Whether the user is still active, reference values: true & false |
| `view_referrer` | string   | Page referrer                                            |
| `view_name`     | string   | Page URL                                             |

#### Action Properties

| Field      | Type | Description                                                     |
| ------------- | -------- | ------------------------------------------------------------ |
| `action_id`   | string   | Unique ID generated for each user action                                   |
| `action_name` | string   | Action name                                                     |
| `action_type` | string   | Action type:<br>launch - Launch (no view-related information)<br>package_download - Package download (no view-related information)<br>script_insert - Script injection (no view-related information)<br>click - Click, etc. |

#### Metrics

| Field | Type | Description |
| --- | --- | --- |
| `duration` | number(ns) | Time spent on the action |

#### Statistical Metrics

| Field | Type | Description |
| --- | --- | --- |
| `action_long_task_count` | number | Number of long tasks associated with the action |
| `action_resource_count` | number | Number of resource requests associated with the action |
| `action_error_count` | number | Number of errors associated with the action |