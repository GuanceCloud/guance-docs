# UniApp Application Data Collection
---

## Introduction

UniApp data collection depends on the Android iOS Native framework. To compare with Android iOS data collection, the following items marked with strikethrough are parts that have not been implemented.

## Data Types

<<< custom_key.brand_name >>> user access monitoring includes six data types.

| **Type** | **Description** |
| --- | --- |
| session | User session information records. During the current session, data related to page views, resources, actions, errors, and long tasks will be recorded based on the session dimension. |
| view | A view record is generated each time a user visits a page in the mobile application. When a user stays on the same page, resource, long task, error, and action records will be linked to the relevant RUM view via the `view_id` attribute. |
| resource | Records of resources loaded when the user visits a page. |
| error | Exceptions or crashes emitted by the mobile application. |
| <del>long_task</del> | <del>An event is generated for any task in the application that blocks the main thread for longer than a specified duration threshold.</del> |
| action | Records user activities in the mobile application (application launch, clicks, swipes, back, etc.). Each action is attached with a unique `action_id`. |

## Global Attributes

Scenarios for user access monitoring and event alerts can be queried using the following global attributes.

### SDK Attributes

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `sdk_name` | string | Collector name, fixed names:<br>`df_macos_rum_sdk`<br>`df_linux_rum_sdk`<br>`df_windows_rum_sdk`<br>`df_web_rum_sdk`<br>`df_miniapp_rum_sdk`<br>`df_ios_rum_sdk`<br>`df_android_rum_sdk` |
| `sdk_version` | string | Collector version information |

### Application Attributes

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `app_id` | string | Required, unique ID identifier for user access applications. Automatically generated when creating monitoring in the <<< custom_key.brand_name >>> console. |
| `env` | string | Required, environment field. Possible values: prod/gray/pre/common/local. Where:<br>prod: production environment<br>gray: gray release environment<br>pre: pre-release environment<br>common: daily environment<br>local: local environment |
| `version` | string | Required, version number. |
| `service` | string | Optional, name of the associated business or service. Fixed names:<br/>`df_rum_ios`<br/>`df_rum_android`<br/>`df_rum_windows`<br/>`df_rum_linux` |

### User & Session Attributes

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `userid` | string | For unlogged users, use a random UUID as `userid`; for logged-in users, use the user ID generated by the application backend. |
| `user_name` | string | Optional, user name. |
| `user_email` | string | Optional, user email. |
| `session_id` | string | Session ID; if no operation for more than 15 minutes, a new `session_id` will be generated. |
| `session_type` | string | Session type. Reference values: user & synthetics<br>user: Data generated by RUM functionality;<br>synthetics: Data generated by headless Synthetic Tests. |
| `is_signin` | boolean | Whether the user is registered, possible values: T & F. |

### Device & Resolution Attributes

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `device` | string | Mobile device manufacturer |
| `model` | string | Mobile device model |
| `device_uuid` | string | Unique ID of the mobile device, generated using Android:[ANDROID_ID](https://developer.android.com/reference/android/provider/Settings.Secure.html#ANDROID_ID) and iOS:[UIDevice.identifierForVendor](https://developer.apple.com/documentation/uikit/uidevice/1620059-identifierforvendor) |
| `os` | string | Operating system information |
| `os_version` | string | Operating system version |
| `os_version_major` | string | Major version of the operating system |
| `screen_size` | string | Screen resolution |

### Geographic & Network Attributes

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `ip` | string | User IP address |
| `isp` | string | ISP provider |
| `network_type` | string | Network connection type, reference values:
wifi &#124; 2g &#124; 3g &#124; 4g &#124; 5g &#124; unknown (unknown network) &#124; unreachable (network unavailable) |
| `country` | string | Country |
| `country_iso_code` | string | Country ISO code |
| `province` | string | Province |
| `city` | string | City |

## Custom Attributes

In addition to global attributes, custom attributes (**SDK supports user-defined tag data**) can be used to build scenarios and configure event alerts. Custom attributes are non-global attributes. By using custom attributes, you can track the entire process of user access to the application, locate and identify affected user visits, and monitor user access performance.

## Other Data Type Attributes

### Session 

#### Properties

| **Field**                      | **Type**   | **Description**                                                        |
| ------------------------- | ------ | ------------------------------------------------------------ |
| `session_id`              | string | Session ID          |
| `session_type`            | string | Session type. Reference values: user & test<br>user: Data generated by RUM functionality;<br>test: Data generated by headless Synthetic Tests. |
| `session_referrer`        | string | Session source, generally recording the URL of the source page.                         |
| `session_first_view_id`   | string | `view_id` of the first page in the current session                                |
| `session_first_view_name` | string | URL of the first page in the current session                                    |
| `session_last_view_id`    | string | `view_id` of the last visited page in the current session                          |
| `session_last_view_name`  | string | URL of the last page in the current session                                  |

#### Metrics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `time_spent` | number(ns) | Duration of the current session |
| `session_view_count` | number | Number of associated `view_id`s in the current session |
| `session_error_count` | number | Number of errors generated in the current session |
| `session_resource_count` | number | Number of resources loaded in the current session |
| `session_action_count` | number | Number of user actions in the current session |
| <del>`session_long_task_count`</del> | number | <del>Number of long tasks generated in the current session</del> |

### View 

#### Properties

| **Field**        | **Type** | **Description**                                            |
| --------------- | -------- | --------------------------------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited                          |
| `view_referrer` | string   | Source page, parent page                                |
| `view_name`     | string   | Page name                                            |

#### Metrics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| <del>`loading_time`</del> | number(ns) | <del>Loading time of the page</del> |
| `time_spent` | number(ns) | Time spent on the page |
| `is_active`     | boolean  | Indicates whether the user is still active, reference values: true & false |

#### Statistics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `view_error_count` | number | Number of errors that occurred during each page load |
| `view_resource_count` | number | Number of resources requested during each page load |
| <del>`view_long_task_count`</del>| number | <del>Number of long tasks generated during each page load</del> |
| `view_action_count` | number | Number of operations performed during the page view |

#### Monitoring Metrics

| **Field**                    | **Type** | **Description**                 |
| --------------------------- | -------- | ------------------------ |
| `cpu_tick_count`            | number   | Optional, CPU tick count for the page    |
| `cpu_tick_count_per_second` | number   | Optional, average CPU ticks per second  |
| `fps_avg`                   | number   | Optional, average frames per second   |
| `fps_mini`                  | number   | Optional, minimum frames per second   |
| `memory_avg`                | number   | Optional, average memory usage      |
| `memory_max`                | number   | Optional, peak memory usage       |

### Resource

#### View Properties

| **Field**        | **Type** | **Description**                                            |
| --------------- | -------- | --------------------------------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited                          |
| `view_referrer` | string   | Source page, parent page                                |
| `view_name`     | string   | Page name                                            |

#### Action Properties

| **Field**      | **Type** | **Description**                            |
| ------------- | -------- | ----------------------------------- |
| `action_id`   | string   | Unique ID generated when a user performs an action on a page          |
| `action_name` | string   | Action name                            |
| `action_type` | string   | Action type (cold/hot start, click, etc.) |

#### Resource Properties

| **Field**                  | **Type** | **Description**                 |
| ------------------------- | -------- | ------------------------ |
| `resource_url`            | string   | Resource URL                  |
| `resource_url_host`       | string   | Domain part of the resource URL         |
| `resource_url_path`       | string   | Path part of the resource URL         |
| `resource_url_query`      | string   | Query part of the resource URL        |
| `resource_url_path_group` | string   | Grouped path part of the resource URL         |
| `resource_type`           | string   | Category of the resource               |
| `resource_method`         | string   | Resource request method             |
| `resource_status`         | string   | Status code returned by the resource request     |
| `resource_status_group`   | string   | Grouped status code returned by the resource request |

#### Metrics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| <del>`resource_size` </del>| number | <del>Size of the resource, default unit: byte </del>|
| <del>`resource_dns` </del>| number(ns) | <del>DNS lookup time for resource loading<br>Calculated as: domainLookupEnd - domainLookupStart </del>|
| <del>`resource_tcp` </del>| number(ns) | <del>TCP connection time for resource loading<br>Calculated as: connectEnd - connectStart</del>|
| <del>`resource_ssl` </del>| number(ns) |<del> SSL connection time for resource loading<br>Calculated as: connectEnd - secureConnectStart </del>|
| <del>`resource_ttfb`</del>| number(ns) | <del>Time to first byte for resource loading<br>Calculated as: responseStart - requestStart</del> |
|<del> `resource_trans` </del>| number(ns) | <del>Content transfer time for resource loading<br>Calculated as: responseEnd - responseStart </del>|
| <del>`resource_first_byte` </del>| number(ns) | <del>First byte time for resource loading<br>Calculated as: responseStart - domainLookupStart </del>|
| <del>`duration`</del>| number(ns) | <del>Total loading time for resource<br>Calculated as: duration(responseEnd-startTime) </del>|
| `request_header` | string | Request headers for the resource |
| `response_header`| string | Response headers for the resource |

### Error

#### View Properties

| **Field**        | **Type** | **Description**                                            |
| --------------- | -------- | --------------------------------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited                          |
| `view_referrer` | string   | Source page, parent page                                |
| `view_name`     | string   | Page name                                            |

#### Action Properties

| **Field**      | **Type** | **Description**                            |
| ------------- | -------- | ----------------------------------- |
| `action_id`   | string   | Unique ID generated when a user performs an action on a page          |
| `action_name` | string   | Action name                            |
| `action_type` | string   | Action type (cold/hot start, click, etc.) |

#### Error Properties

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `error_source` | string | Error source, reference values: logger &#124; network |
| `error_type` | string | **Error type**<br>logger error type:  java_crash &#124; ios_crash<br>network error type: network_error |
| `error_situation` | string | Timing of the error occurrence, reference values: startup (at startup) and run (during runtime) |

When **type=network**, additional Network Error properties are added.

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `resource_status` | string | Status code returned by the resource request |
| `resource_url` | string | Resource URL |
| `resource_url_host` | string | Domain part of the resource URL |
| `resource_url_path` | string | Path part of the resource URL |
| `resource_url_path_group` | string | Grouped path part of the resource URL |
| `resource_method` | string | Resource request method |

#### Error Monitoring Properties

| **Field**       | **Type** | **Description**             |
| -------------- | -------- | -------------------- |
| `memory_total` | string   | Optional, total memory       |
| `memory_use`   | number   | Optional, memory usage rate     |
| `cpu_use`      | number   | Optional, CPU usage rate     |
| `battery_use`  | number   | Optional, current battery level |
| `locale`       | string   | Current system language         |

#### Metrics

| **Field**        | **Type** | **Description** |
| --------------- | -------- | -------- |
| `error_message` | string   | Error message |
| `error_stack`   | string   | Error stack trace |

### Long Task

#### View Properties

| **Field**        | **Type** | **Description**                   |
| --------------- | -------- | -------------------------- |
| <del>`view_id`</del> | string   | <del>Unique ID generated each time a page is visited</del> |
| <del>`view_referrer`</del> | string   | <del>Source page, parent page</del> |
| <del>`view_name`</del> | string   | <del>Page name</del>        |

#### Action Properties

| **Field**      | **Type** | **Description**                            |
| ------------- | -------- | ----------------------------------- |
| <del>`action_id`</del> | string   | <del>Unique ID generated when a user performs an action on a page</del> |
| <del>`action_name`</del> | string   | <del>Action name</del>                 |
| <del>`action_type`</del> | string   | <del>Action type (cold/hot start, click, etc.)</del> |

#### Metrics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| <del>`duration`</del> | number(ns) | <del>Duration of the long task</del> |
| <del>`long_task_message`</del> | string | <del>Long task message</del> |
| <del>`long_task_stack`</del> | string | <del>Long task stack trace</del> |

### Action

#### View Properties

| **Field**        | **Type** | **Description**                   |
| --------------- | -------- | -------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited |
| `view_referrer` | string   | Source page, parent page       |
| `view_name`     | string   | Page name                   |

#### Action Properties

| **Field**      | **Type** | **Description**                            |
| ------------- | -------- | ----------------------------------- |
| `action_id`   | string   | Unique ID generated when a user performs an action on a page          |
| `action_name` | string   | Action name                            |
| `action_type` | string   | Action type (cold/hot start, click, etc.) |

#### Metrics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `duration` | number(ns) | Time taken for the page action |

#### Statistics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `action_long_task_count` | number | Number of long tasks associated with the action |
| `action_resource_count` | number | Number of resource requests associated with the action |
| `action_error_count` | number | Number of errors associated with the action |