# React Native Application Data Collection
---

## Introduction
React Native data collection relies on the Android and iOS native frameworks. To compare with Android and iOS data collection, the following strikethrough items are parts that have not been implemented.

## Data Types

Guance's RUM includes six types of data.

| **Type** | **Description** |
| --- | --- |
| session | Records user session information. During the current session, data related to user pages, resources, actions, errors, and long tasks will be recorded based on the session dimension. |
| view | A view record is generated each time a user visits a page in a mobile application. When a user stays on the same page, resource, long task, error, and action records are linked to the relevant RUM view via the `view_id` attribute. |
| resource | Records information about resources loaded when a user visits a page. |
| error | Exceptions or crashes issued by the mobile application. |
| <del>long_task</del> | <del>An event is generated for any task in the application that blocks the main thread for longer than a specified duration threshold.</del> |
| action | Records user activities in the mobile application (such as app launches, clicks, swipes, back actions, etc.). Each action has a unique `action_id`. |

## Global Properties

Scenarios and event alerts in RUM can be queried using the following global properties.

### SDK Properties

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `sdk_name` | string | Collector name, fixed names:<br>`df_macos_rum_sdk`<br>`df_linux_rum_sdk`<br>`df_windows_rum_sdk`<br>`df_web_rum_sdk`<br>`df_miniapp_rum_sdk`<br>`df_ios_rum_sdk`<br>`df_android_rum_sdk` |
| `sdk_version` | string | Collector version information |

### Application Properties

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `app_id` | string | Required, unique ID for the user-accessed application, auto-generated when creating monitoring in the Guance console. |
| `env` | string | Required, environment field. Possible values: prod/gray/pre/common/local. Where:<br>prod: Production Environment<br>gray: Gray Release Environment<br>pre: Pre-release Environment<br>common: Daily Environment<br>local: Local Environment |
| `version` | string | Required, version number. |
| `service` | string | Optional, name of the associated business or service. Fixed names:<br/>`df_rum_ios`<br/>`df_rum_android`<br/>`df_rum_windows`<br/>`df_rum_linux` |

### User & Session Properties

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `userid` | string | For unlogged users, a random UUID is used as `userid`; for logged-in users, the user ID generated by the application backend is used. |
| `user_name` | string | Optional, user name. |
| `user_email` | string | Optional, user email. |
| `session_id` | string | Session ID; if no operation occurs for more than 15 minutes, a new `session_id` is generated. |
| `session_type` | string | Session type. Reference values: user & synthetics<br>user: Data generated by RUM functionality;<br>synthetics: Data generated by headless Synthetic Tests. |
| `is_signin` | boolean | Whether the user is registered, possible values: T & F. |

### Device & Resolution Properties

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `device` | string | Mobile device manufacturer |
| `model` | string | Mobile device model |
| `device_uuid` | string | Unique ID for the mobile device, generated using Android:[ANDROID_ID](https://developer.android.com/reference/android/provider/Settings.Secure.html#ANDROID_ID)、iOS:[UIDevice.identifierForVendor](https://developer.apple.com/documentation/uikit/uidevice/1620059-identifierforvendor) |
| `os` | string | Operating system information |
| `os_version` | string | Operating system version |
| `os_version_major` | string | Major operating system version |
| `screen_size` | string | Screen resolution |

### Geographic & Network Properties

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `ip` | string | User access IP address |
| `isp` | string | ISP |
| `network_type` | string | Network connection type, reference values:<br>wifi &#124; 2g &#124; 3g &#124; 4g &#124; 5g &#124; unknown (unknown network) &#124; unreachable (network unavailable) |
| `country` | string | Country |
| `country_iso_code` | string | Country ISO code |
| `province` | string | Province |
| `city` | string | City |

## Custom Properties

In addition to global properties, custom properties (**SDK supports users tagging custom data**) can be used to build scenarios and configure event alerts. Custom properties are non-global properties that allow tracking the entire process of user visits, identifying and discovering affected user visits, and monitoring user visit performance.

## Other Data Type Attributes

### Session 

#### Attributes

| **Field**                      | **Type**   | **Description**                                                        |
| ------------------------- | ------ | ------------------------------------------------------------ |
| `session_id`              | string | Session ID          |
| `session_type`            | string | Session type. Reference values: user & test<br>user: Data generated by RUM functionality;<br>test: Data generated by headless Synthetic Tests. |
| `session_referrer`        | string | Session source, generally recording the URL of the source page.                         |
| `session_first_view_id`   | string | The `view_id` of the first page in the current session                                |
| `session_first_view_name` | string | The URL of the first page in the current session                                    |
| `session_last_view_id`    | string | The `view_id` of the last visited page in the current session                          |
| `session_last_view_name`  | string | The URL of the last page in the current session                                  |

#### Metrics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `time_spent` | number(ns) | Duration of the current session |
| `session_view_count` | number | Number of associated `view_id`s in the current session |
| `session_error_count` | number | Number of errors in the current session |
| `session_resource_count` | number | Number of resources loaded in the current session |
| `session_action_count` | number | Number of user actions in the current session |
| <del>`session_long_task_count`</del> | number | <del>Number of long tasks in the current session</del> |

### View 

#### Attributes

| **Field**        | **Type** | **Description**                                            |
| --------------- | -------- | --------------------------------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited |
| `view_referrer` | string   | Parent page of the current page                   |
| `view_name`     | string   | Page name                                         |

#### Metrics

| **Field** | **Type** | **Description**   |
| --- | --- | --- |
| `loading_time` | number（ns） | Page loading time |
| `time_spent` | number（ns） | Time spent on the page |
| `is_active`     | boolean  | Indicates whether the user is still active, reference values: true & false |

#### Statistics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `view_error_count` | number | Number of errors during each page load |
| `view_resource_count` | number | Number of resources requested during each page load |
| <del>`view_long_task_count`</del> | number | <del>Number of long tasks during each page load</del> |
| `view_action_count` | number | Number of actions during the page view |

#### Monitoring Metrics

| **Field**                    | **Type** | **Description**                 |
| --------------------------- | -------- | ------------------------ |
| `cpu_tick_count`            | number   | Optional, CPU tick count for the page    |
| `cpu_tick_count_per_second` | number   | Optional, average CPU ticks per second  |
| `fps_avg`                   | number   | Optional, average frames per second   |
| `fps_mini`                  | number   | Optional, minimum frames per second   |
| `memory_avg`                | number   | Optional, average memory usage       |
| `memory_max`                | number   | Optional, peak memory usage       |

### Resource

#### View Attributes

| **Field**        | **Type** | **Description**                   |
| --------------- | -------- | -------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited |
| `is_active`     | boolean  | Indicates whether the user is still active, reference values: true & false |
| `view_referrer` | string   | Parent page of the current page       |
| `view_name`     | string   | Page name                   |

#### Action Attributes

| **Field**      | **Type** | **Description**                            |
| ------------- | -------- | ----------------------------------- |
| `action_id`   | string   | Unique ID generated each time a user performs an action on a page          |
| `action_name` | string   | Action name                            |
| `action_type` | string   | Action type (cold/hot start, click, etc.) |

#### Resource Attributes

| **Field**                  | **Type** | **Description**                 |
| ------------------------- | -------- | ------------------------ |
| `resource_url`            | string   | Resource URL                  |
| `resource_url_host`       | string   | Domain part of the resource URL         |
| `resource_url_path`       | string   | Path part of the resource URL         |
| `resource_url_query`      | string   | Query part of the resource URL        |
| `resource_url_path_group` | string   | Path group of the resource URL         |
| `resource_type`           | string   | Category of the resource               |
| `resource_method`         | string   | Resource request method             |
| `resource_status`         | string   | Status value returned by the resource request     |
| `resource_status_group`   | string   | Status group value returned by the resource request |

#### Metrics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `resource_size` | number | Size of the resource, default unit: byte |
| `resource_dns` | number（ns） | DNS resolution time for resource loading<br>Calculation method: domainLookupEnd - domainLookupStart |
| `resource_tcp` | number（ns） | TCP connection time for resource loading<br>Calculation method: connectEnd - connectStart |
| `resource_ssl` | number（ns） | SSL connection time for resource loading<br>Calculation method: connectEnd - secureConnectStart |
| `resource_ttfb` | number（ns） | Response time for resource loading<br>Calculation method: responseStart - requestStart |
| `resource_trans` | number（ns） | Content transmission time for resource loading<br>Calculation method: responseEnd - responseStart |
| `resource_first_byte` | number（ns） | First byte time for resource loading<br>Calculation method: responseStart - domainLookupStart |
| `duration` | number（ns） | Total loading time for the resource<br>Calculation method: duration(responseEnd-startTime) |

### Error

#### View Attributes

| **Field**        | **Type** | **Description**                                        |
| :-------------- | :------- | :---------------------------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited                      |
| `view_referrer` | string   | Parent page of the current page                            |
| `view_name`     | string   | Page name                                        |

#### Action Attributes

| **Field**      | **Type** | **Description**                            |
| ------------- | -------- | ----------------------------------- |
| `action_id`   | string   | Unique ID generated each time a user performs an action on a page          |
| `action_name` | string   | Action name                            |
| `action_type` | string   | Action type (cold/hot start, click, etc.) |

#### Error Attributes

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `error_source` | string | Error source, reference values: logger &#124; network |
| `error_type` | string | Error type<br>logger error type: reactnative_crash &#124; java_crash &#124; native_crash &#124; anr_error &#124; anr_crash &#124; ios_crash<br>network error type：network_error |
| `error_situation` | string | Timing of the error occurrence, reference values: startup (startup) and run (runtime) |

**When `type=network`, additional Network Error attributes are added.**

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `resource_status` | string | Status value returned by the resource request |
| `resource_url` | string | Resource URL |
| `resource_url_host` | string | Domain part of the resource URL |
| `resource_url_path` | string | Path part of the resource URL |
| `resource_url_path_group` | string | Path group of the resource URL |
| `resource_method` | string | Resource request method |

#### Error Monitoring Attributes

| **Field**       | **Type** | **Description**             |
| -------------- | -------- | -------------------- |
| `memory_total` | string   | Optional, total memory       |
| `memory_use`   | number   | Optional, memory usage rate     |
| `cpu_use`      | number   | Optional, CPU usage rate     |
| `battery_use`  | number   | Optional, current phone battery level |
| `locale`       | string   | Current system language         |

#### Metrics

| **Field**        | **Type** | **Description** |
| --------------- | -------- | -------- |
| `error_message` | string   | Error message |
| `error_stack`   | string   | Error stack |

### Long Task

#### View Attributes


| **Field**        | **Type** | **Description**                   |
| --------------- | -------- | -------------------------- |
| <del>`view_id`</del> | string   | <del>Unique ID generated each time a page is visited</del> |
| <del>`view_referrer`</del> | string   | <del>Parent page of the current page</del> |
| <del>`view_name`</del> | string   | <del>Page name</del>        |

#### Action Attributes

| **Field**      | **Type** | **Description**                            |
| ------------- | -------- | ----------------------------------- |
| <del>`action_id`</del> | string   | <del>Unique ID generated each time a user performs an action on a page</del> |
| <del>`action_name`</del> | string   | <del>Action name</del>                 |
| <del>`action_type`</del> | string   | <del>Action type (cold/hot start, click, etc.)</del> |


#### Metrics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| <del>`duration`</del> | number（ns） | <del>Duration of the long task</del> |
| <del>`long_task_message`</del> | string | <del>Long task information</del> |
| <del>`long_task_stack`</del> | string | <del>Long task stack trace</del> |

### Action

#### View Attributes

| **Field**        | **Type** | **Description**                   |
| --------------- | -------- | -------------------------- |
| `view_id`       | string   | Unique ID generated each time a page is visited |
| `view_referrer` | string   | Parent page of the current page       |
| `view_name`     | string   | Page name                   |

#### Action Attributes

| **Field**      | **Type** | **Description**                            |
| ------------- | -------- | ----------------------------------- |
| `action_id`   | string   | Unique ID generated each time a user performs an action on a page          |
| `action_name` | string   | Action name                            |
| `action_type` | string   | Action type (cold/hot start, click, etc.) |

#### Metrics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| `duration` | number（ns） | Time spent on the action |

#### Statistics

| **Field** | **Type** | **Description** |
| --- | --- | --- |
| <del>`action_long_task_count`</del> | number | <del>Number of long tasks associated with the action</del> |
| `action_resource_count` | number | Number of resource requests associated with the action |
| `action_error_count` | number | Number of errors associated with the action |