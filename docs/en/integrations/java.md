---
title     : 'JAVA'
summary   : 'Get metrics, link tracking, and log information for JAVA applications'
__int_icon: 'icon/jvm'
dashboard :
  - desc  : 'No'
    path  : '-'
monitor   :
  - desc  : 'No'
    path  : '-'
---


<!-- markdownlint-disable MD025 -->
# JAVA
<!-- markdownlint-enable -->

Link to the JAVA application using the observation cloud:

- Collect custom metrics data from applications;
- Collect link tracking data from applications;
- Manage all logs for the application.

## Configuration {#config}

### Metric Collection

You can view [jvm doc](jvm.md)

### Link Tracking Collection

Apply Open Correspondence ***Collector***, then use the JAVA agent tool to get traces information and send it to the observation cloud.
<!-- markdownlint-disable MD046 -->
=== "OpenTelemetry"

    [OpenTelemetry Collector](opentelemetry.md)

=== "DDTrace"

    [DDTrace Collector](ddtrace.md)

=== "SkyWalking"

    [SkyWalking Collector](skywalking.md)

=== "Jaeger"

    [Jaeger Collector](jaeger.md)

=== "Zipkin"

    [Zipkin Collector](zipkin.md)

=== "CAT"

    [CAT Collector](cat.md)

=== "Pinpoint"

    [Pinpoint Collector](pinpoint.md)

<!-- markdownlint-enable -->
## Logging {#logging}

 `opentelemetry-java` (hereinafter referred to as "Agent") is injected into the application through `javaagent`. After the application generates trace information, the `traceId` and `spanId` can be passed as parameters to `log` so that `log` will be output with `traceId` and `spanId`.
<!-- markdownlint-disable MD046 -->
????+ Info "About MDC"

<!-- markdownlint-enable -->
It contains thread local context information and copies it to each log event captured by the log library.

OTEL JAVA Agent injects several pieces of information about the current span into the MDC copy of each logged event:

- ***trace_id***current tracking ID (same as `Span.current().getSpanContext().getTraceId()`);
- ***span_id***current span ID (same as `Span.current().getSpanContext().getSpanId()`);
- ***trace_flags***Current trace flag, formatted according to W3C trace flag format (same as `Span.current().getSpanContext().getTraceFlags().asHex()`).

These three pieces of information can be included in the log statements generated by the log library by specifying them in the pattern/format.

Tip: For SpringBoot configurations that use `logback`, you can add MDC to the log line `logging.pattern.level` by simply overwriting:

```bash
logging.pattern.level = trace_id=%mdc{trace_id} span_id=%mdc{span_id} trace_flags=%mdc{trace_flags} %5p
```

This allows any service or tool that parses the application log to associate trace/span with log statements.

### Log Configuration

The APM tool configuration logs `pattern` differ from each other. Take `logback.xml` for example:
<!-- markdownlint-disable MD046 -->
=== "OpenTelemetry"

    OpenTelemetry MDC parameter：

    - trace_id
    - span_id

    ```xml
    <property name="log.pattern" value="%d{HH:mm:ss} [%thread] %-5level %logger{10} [traceId=%X{trace_id} spanId=%X{span_id} userId=%X{user-id}] %msg%n" />

    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>${log.pattern}</pattern>
            <charset>UTF-8</charset>
        </encoder>
    </appender>
    ```

=== "DDTrace"

    DDTrace MDC parameter：

    - dd.service
    - dd.trace_id
    - dd.span_id

    ```xml
    <property name="log.pattern" value="%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger - [%method,%line] %X{dd.service} %X{dd.trace_id} %X{dd.span_id} - %msg%n" />

    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>${log.pattern}</pattern>
            <charset>UTF-8</charset>
        </encoder>
    </appender>-
    ```
<!-- markdownlint-enable -->

## Doc {#faq}


[**DDTrace Log**](https://docs.guance.com/best-practices/insight/ddtrace-skill-log/)

[**springboot-ddtrace-server**](https://github.com/lrwh/observable-demo/blob/main/springboot-ddtrace-server/src/main/resources/logback-spring.xml)

[**springboot-opentelemetry-otlp-server**](https://github.com/lrwh/observable-demo/blob/main/springboot-opentelemetry-otlp-server/src/main/resources/logback-spring.xml)


