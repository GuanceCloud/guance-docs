# 计费方式
---


## 概览

观测云支持按需购买，按量付费的计费方式。按照 DataKit 数量、时间线数量、日志类数据数量、备份日志数据数量、任务调用次数、用户访问 PV 数量、应用性能 Trace 数量、可用性监测拨测任务次数、短信发送次数等多个维度进行价格统计。


## 计费价格

观测云计费项分成全量统计和增量统计，详情说明可参考名词解释。

观测云计费价格分成两种计算方式：一种是基于数据统计的基础计费模式，另外一种是基于数据统计及 [数据存储策略](../../billing/billing-method/data-storage.md) 的梯度计费模式。日志类数据、应用性能 Trace、用户访问 PV 这三个计费项采用梯度计费模式，其他计费项采用基础计费模式。

### 基础计费模式 {#basic}

观测云提供两种计费模式，可在费用中心切换选择。一种是统计“DataKit+时间线”数量的计费模式，另外一种是仅统计“时间线”数量的计费模式。其他计费项备份日志数据数量、API拨测次数、任务调度次数、短信发送次数为通用计费项。


#### 调整计费模式
观测云默认为“DataKit+时间线”的计费模式，若需要修改为“时间线”的计费模式需要联系观测云客户经理在观测云计费平台进行更改。


#### 统计“DataKit+时间线”数量
| **计费项** | **计费单元** | **商业版单价** |
| --- | --- | --- |
| Datakit 数量 | 每 1 台 | 3 元 |
| 时间线数量 | 每 1000 条 | 3 元 |
| 备份日志数据容量 | 每 1 GB 数据 | 0.007 元 |
| 可用性监测拨测任务次数 | 每 1 万次 | 1 元<br />注意：统计不包含自建节点产生的API拨测的数据 |
| 任务调用次数 | 每 1 万次 | 1 元 |
| 短信发送次数 | 每 10 次 | 1 元 |

时间线计算公式：

- 计费时间线数量 = 时间线数量 - DataKit数量 * 1000
- 计费时间线数量账单 = （时间线数量 - DataKit数量 * 300）/ 1000 * 3
- 若计算得出的计费时间线数量 <= 0，则按照 0 条计算。

注意：

- 此计费模式下，每台 DataKit 有 300 条时间线的免费使用额度
- DataKit 存活 12 小时以上才会被统计为计费 DataKit


#### 统计“时间线”数量
| **计费项** | **计费单元** | **商业版单价** |
| --- | --- | --- |
| 时间线数量 | 每 1000 条 | 3 元 |
| 备份日志数据数量 | 每 1 GB 数据 | 0.007 元 |
| 可用性监测拨测任务次数 | 每 1 万次 | 1 元<br>注意：统计不包含自建节点产生的API拨测的数据 |
| 任务调用次数 | 每 1 万次 | 1 元 |
| 短信发送次数 | 每 10 次 | 1 元 |

时间线计算公式：

- 计费时间线数量 = 时间线数量
- 计费时间线数量账单 = 时间线数量  / 1000 * 3


### 梯度计费模式 {#gradient}


#### 日志类数据

| **计费项** | **计费单元** | **商业版梯度价格** |  |  |  |
| --- | --- | --- | --- | --- | --- |
| 数据存储策略 |  | 7 天 | 14 天 | 30 天 | 60 天 |
| 日志类数据数量 | 每百万条 | 1.2 元 | 1.5 元 | 2 元 | 2.5 元 |


#### 应用性能 Trace
| **计费项** | **计费单元** | **商业版梯度价格** |  |  |
| --- | --- | --- | --- | --- |
| 数据存储策略 |  | 3 天 | 7 天 | 14 天 |
| 应用性能 Trace 数量 | 每百万个 | 2 元 | 3 元 | 6 元 |


#### 用户访问 PV
| **计费项** | **计费单元** | **商业版梯度价格** |  |  |
| --- | --- | --- | --- | --- |
| 数据存储策略 |  | 3 天 | 7 天 | 14 天 |
| 用户访问 PV 数量 | 每万个 | 0.7 元 | 1 元 | 2 元 |


### 计费公式

- 按天出账
- 计费项账单 = 计费单元数量 * 单价
- 计费项单元数量 = 实际统计数量 / 计费单元（注意：此处结果值不做进位处理，保留数值小数点后两位）


### 计费示例

假设A公司使用观测云对公司的 IT 基础设施、应用系统等进行整体观测，统计7天的费用示例。


#### 1.基础计费

基础计费项包括全量计费项和增量计费项，时间线和备份日志数据数量为全量计费项，DataKit数量、API拨测次数、任务调度次数、短信发送次数为增量计费项。下面将以两种不同基础计费模式进行示例，包括DataKit、时间线和任务调度计费项的费用统计。

**1）按照“DataKit+时间线”的计费模式，7天的总费用：DataKit+时间线+任务调度的费用总计=420+73.8+9=502.8元**

- 每 1 台 DataKit 单价3元

| DataKit | Day1 | Day2 | Day3 | Day4 | Day5 | Day6 | Day7 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 单日用量 | 10 | 10 | 15 | 15 | 30 | 30 | 30 |
| 增量计费 | 10 | 10 | 15 | 15 | 30 | 30 | 30 |
| 总计(元) | 30 | 30 | 45 | 45 | 90 | 90 | 90 |


DataKit 7天的总费用=30+30+45+45+90+90+90=420元

- 每1000条时间线单价3元，计费时间线数量账单 = （时间线数量 - DataKit数量 * 1000）/ 1000 * 3，若计算得出的计费时间线数量 <= 0，则按照 0 条计算。

| 时间线 | Day1 | Day2 | Day3 | Day4 | Day5 | Day6 | Day7 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 单日用量 | 500 | 500 | 500 | 500 | 800 | 800 | 30000 |
| 全量计费 | 500 | 1000 | 1500 | 2000 | 2800 | 3600 | 33600 |
| 总计(元) | 0 | 0 | 0 | 0 | 0 | 0 | (33600-30 * 300)/1000 * 3=73.8 |

时间线 7天的总费用=73.8元

- 每1万次任务调度单价1元

| 任务调度 | Day1 | Day2 | Day3 | Day4 | Day5 | Day6 | Day7 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 单日用量 | 1万 | 1万 | 1万 | 1万 | 1.5万 | 1.5万 | 2万 |
| 增量计费 | 1万 | 1万 | 1万 | 1万 | 1.5万 | 1.5万 | 2万 |
| 总计(元) | 1 | 1 | 1 | 1 | 1.5 / 1 * 1=1.5 | 1.5 / 1 * 1=1.5 | 2 / 1 * 1=2 |

任务调度 7天的总费用=1+1+1+1+1.5+1.5+2=9元

**2）按照“时间线”的计费模式，DataKit数量不收费，7天的总费用：时间线+任务调度的费用总计=135+9=144元**

- 每1000条时间线单价3元，计费时间线数量账单 = 时间线数量 / 1000 * 3

| 时间线 | Day1 | Day2 | Day3 | Day4 | Day5 | Day6 | Day7 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 单日用量 | 500 | 500 | 500 | 500 | 800 | 800 | 30000 |
| 全量计费 | 500 | 1000 | 1500 | 2000 | 2800 | 3600 | 33600 |
| 总计(元) | 500 / 1000 * 3=1.5 | 1000 / 1000 * 3=3 | 4.5 | 6 | 8.4 | 10.8 | 100.8 |

时间线 7天的总费用=1.5+3+4.5+6+8.4+10.8+100.8=135元

2）增量计费项统计以任务调度举例，每1万次单价1元

| 任务调度 | Day1 | Day2 | Day3 | Day4 | Day5 | Day6 | Day7 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 单日用量 | 1万 | 1万 | 1万 | 1万 | 1.5万 | 1.5万 | 2万 |
| 增量计费 | 1万 | 1万 | 1万 | 1万 | 1.5万 | 1.5万 | 2万 |
| 总计(元) | 1 | 1 | 1 | 1 | 1.5 / 1 * 1=1.5 | 1.5 / 1 * 1=1.5 | 2 / 1 * 1=2 |

任务调度 7天的总费用=1+1+1+1+1.5+1.5+2=9元


#### 2.梯度计费

梯度计费项都是增量计费，下面以日志类数据为例，对比不同梯度，相同用量下的费用：

1）数据存储策略为7天，每百万条梯度价格1.2元

| 日志数据 | Day1  | Day2  | Day3  | Day4  | Day5              | Day6              | Day7            |
| -------- | ----- | ----- | ----- | ----- | ----------------- | ----------------- | --------------- |
| 单日用量 | 1百万 | 1百万 | 1百万 | 1百万 | 1.5百万           | 1.5百万           | 2百万           |
| 增量计费 | 1百万 | 1百万 | 1百万 | 1百万 | 1.5百万           | 1.5百万           | 2百万           |
| 总计(元) | 1.2   | 1.2   | 1.2   | 1.2   | 1.5 / 1 * 1.2=1.8 | 1.5 / 1 * 1.2=1.8 | 2 / 1 * 1.2=2.4 |

7天的总费用=1.2+1.2+1.2+1.2+1.8+1.8+2.4=10.8元，后面以此类推进行费用统计。

2）数据存储策略为14天，每百万条梯度价格1.5元

| 日志数据 | Day1 | Day2 | Day3 | Day4 | Day5 | Day6 | Day7 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 单日用量 | 1百万 | 1百万 | 1百万 | 1百万 | 1.5百万 | 1.5百万 | 2百万 |
| 增量计费 | 1百万 | 1百万 | 1百万 | 1百万 | 1.5百万 | 1.5百万 | 2百万 |
| 总计(元) | 1.5 | 1.5 | 1.5 | 1.5 | 1.5 / 1 * 1.5=2.25 | 1.5 / 1 * 1.5=2.25 | 2 / 1 * 1.5=3 |

7天的总费用=1.5+1.5+1.5+1.5+2.25+2.25+3=13.5元，后面以此类推进行费用统计。

3）数据存储策略为30天，每百万条梯度价格2元

| 日志数据 | Day1 | Day2 | Day3 | Day4 | Day5 | Day6 | Day7 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 单日用量 | 1百万 | 1百万 | 1百万 | 1百万 | 1.5百万 | 1.5百万 | 2百万 |
| 增量计费 | 1百万 | 1百万 | 1百万 | 1百万 | 1.5百万 | 1.5百万 | 2百万 |
| 总计(元) | 2 | 2 | 2 | 2 | 1.5 / 1 * 2=3 | 1.5 / 1 * 2=3 | 2 / 1 * 2=4 |

7天的总费用=2+2+2+2+3+3+4=18元，后面以此类推进行费用统计。

4）数据存储策略为60天，每百万条梯度价格2.5元

| 日志数据 | Day1 | Day2 | Day3 | Day4 | Day5 | Day6 | Day7 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 单日用量 | 1百万 | 1百万 | 1百万 | 1百万 | 1.5百万 | 1.5百万 | 2百万 |
| 增量计费 | 1百万 | 1百万 | 1百万 | 1百万 | 1.5百万 | 1.5百万 | 2百万 |
| 总计(元) | 2.5 | 2.5 | 2.5 | 2.5 | 1.5 / 1 * 2.5=3.75 | 1.5 / 1 * 2.5=3.75 | 2 / 1 * 2.5=5 |

7天的总费用=2.5+2.5+2.5+2.5+3.75+3.75+5=22.5元，后面以此类推进行费用统计。


## 名词解释	


### 全量统计

当前工作空间下，统计数据保存策略范围内所有的数据 / 数量。时间线、备份日志数据这两个计费项按照全量计费。


### 增量统计

当前工作空间下，统计一天内产生的数据 / 数量。DataKit 、日志类数据、应用性能 Trace、用户访问 PV 、API 拨测、任务调度、短信按照增量计费。


### DataKit 数量

当前工作空间下，一天内有数据上报的datakit的数量。由于目前datakit数量是按小时做数量统计，所以当天datakit的实际数量取24个点里面的最大值。

注意：主机安装 DataKit 开启采集数据后，变更主机名`host_name`会默认新增加一台主机，原主机名会继续在「基础设施」-「主机」列表中显示，一个小时后不会继续上报数据，直到24小时未上报数据后从列表中移除。由于 DataKit 数量是在24小时内取最大值，故在这个计费周期内会被统计为2台主机进行收费。


### 时间线数量

当前工作空间，上报的指标数据中基于标签可以组合而成的所有组合数量。

在观测云中时间线是由指标、标签（字段）、数据存储时长组合而成的，“指标”和“标签（字段）的组合”是数据存储的主键。例如：如果有 `天气` 这个指标，数据存储时长一样。

```
2021-04-15T00:00:00Z 天气,国家=中国,地区=上海 温度=23.1
2021-04-15T00:00:00Z 天气,国家=中国,地区=杭州 温度=22.2
2021-04-15T00:00:00Z 天气,国家=美国,地区=纽约 温度=23.3
2021-04-15T00:00:00Z 天气,国家=美国,地区=洛杉矶 温度=21.2
2021-04-15T00:00:10Z 天气,国家=中国,地区=上海 温度=23.3
2021-04-15T00:00:10Z 天气,国家=中国,地区=杭州 温度=20.2
2021-04-15T00:00:10Z 天气,国家=美国,地区=纽约 温度=24.3
2021-04-15T00:00:10Z 天气,国家=美国,地区=洛杉矶 温度=25.2
```

如上所述，包含 1 个指标：【天气】；4 个标签组合：【中国 上海】【中国 杭州】【美国 纽约】【美国 洛杉矶】；则当前指标 `天气` 的时间线数量为： `1(指标个数) x 4(标签的组合个数) = 4 个时间线`

**注意：数据存储时长是采集上来的数据在平台中保存的时间，超过存储时长的数据将会自动删除。**

#### 相关名词解释

- Database：数据库
- Measurement：数据表，可以理解为 mysql 里的 table，指标集
- Field：InfluxDB 中记录真实数据的键值对 (在 Influxdb 中是必须的，不会被索引)，指标
- Field Set：Field 键值对的集合
- Field Key：组成 Field 键值对里的键
- Field Value：组成 Field 键值对里的值 (真正的数据)
- Tag：用来描述 Field 的键值对 (在 Influxdb 中是可选的，会被索引)，标签
- Tag Set：Tag 键值对的集合
- Tag Key：组成 Tag 键值对里的键
- Tag Value：组成 Tag 键值对里的值
- TimeStamp：数据点关联的日期和时间
- Retention Policy：数据存储时间 (数据保存策略)
- Series：时间线由 Retention Policy、Measurement、Tag Set 三部分组成


### 日志类数据数量

当前空间下，日志类数据的统计数量，日志类数据数量包括日志、可用性监测（用户自建节点产生的拨测数据）、安全巡检、CI 和事件的数据数量总和，默认计费单位为“百万条”。


### 备份日志数据容量

当前空间下，备份日志数据的统计容量，默认计费单位为“ GB ”。


### 应用性能 Trace 数量

当前空间下，统计应用性能监测 trace_id 的数量，默认计费单位为“百万个”。

注意：一整个完整链路算一个 trace , 一条完整链路下有多个 span ，但是 span 对应的 trace_id 都是一样的，最终是按照 trace_id 的数量进行计费。


### 用户访问 PV 数量

当前空间下，统计一天内所有页面浏览产生的 PV 数量，默认计费单位为“千个”。


### 可用性监测拨测任务次数

当前空间下，统计一天内所有的可用性监测产生的拨测任务调用次数，默认计费单位为“万次”。


### 任务调用次数

当前空间下，统计一天内所有的 Func 平台调用的次数，涉及到任务的调用即会进行次数统计，如异常检测的规则数量、生成指标的规则数量等，默认计费单位为“万次”。


### 短信发送次数

当前空间下，统计一天内所有发送出去的短信的次数，默认计费单位为“次”。

## 价格计算

用于计算当前工作空间各个项目的使用情况。用户可计算一天、一个月和一年的使用情况。点击 [价格计算器 ](https://www.dataflux.cn/billing)可自动计算价格。


## 数据存储策略

数据存储时长会影响价格统计，你可以调整当前工作空间指标数据、日志数据、事件数据、安全巡检数据、应用性能数据、用户访问数据的数据存储策略，仅支持商业版工作空间拥有者进入「管理」-「基本设置」，变更数据存储策略。更多说明可参考文档 [数据存储策略](../../billing/billing-method/data-storage.md) 。





